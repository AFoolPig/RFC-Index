<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head profile="http://dublincore.org/documents/2008/08/04/dc-html/"> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta name="robots" content="index,follow" /> 
  <meta name="creator" content="rfcmarkup version 1.127" /> 
  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" /> 
  <meta name="DC.Relation.Replaces" content="draft-hedin-ippm-type-p-monitor" /> 
  <meta name="DC.Identifier" content="urn:ietf:rfc:7750" /> 
  <meta name="DC.Date.Issued" content="February, 2016" /> 
  <meta name="DC.Creator" content="Mirsky, Greg" /> 
  <meta name="DC.Creator" content="Baillargeon, Steve" /> 
  <meta name="DC.Creator" content="Hedin, Jonas" /> 
  <meta name="DC.Description.Abstract" content="This document describes an optional extension for Two-Way Active
Measurement Protocol (TWAMP) allowing the monitoring of the
Differentiated Service Code Point and Explicit Congestion Notification
fields with the TWAMP-Test protocol." /> 
  <meta name="DC.Title" content="Differentiated Service Code Point and Explicit Congestion Notification Monitoring in the Two-Way Active Measurement Protocol (TWAMP)" /> 
  <link rel="icon" href="/images/rfc.png" type="image/png" /> 
  <link rel="shortcut icon" href="/images/rfc.png" type="image/png" /> 
  <title>RFC 7750 - Differentiated Service Code Point and Explicit Congestion Notification Monitoring in the Two-Way Active Measurement Protocol (TWAMP)</title> 
  <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style> 
  <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> 
  <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script> 
 </head> 
 <body onload="addHeaderTags()"> 
  <div class="content"> 
   <div style="height: 13px;"> 
    <div onmouseover="this.style.cursor='pointer';" onclick="showElem('legend');" onmouseout="hideElem('legend')" style="height: 6px; position: absolute;" class="pre noprint docinfo bgblue" title="Click for colour legend."> 
    </div> 
    <div id="legend" class="docinfo noprint pre legend" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; " onmouseover="showElem('legend');" onmouseout="hideElem('legend');"> 
    </div> 
   </div> 
   <span class="pre noprint docinfo top">[<a href="https://tools.ietf.org/html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7750.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7750" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ippm-type-p-monitor" title="draft-ietf-ippm-type-p-monitor">draft-ietf-ippm...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7750" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7750" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7750" title="Side-by-side diff">Diff2</a>] </span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <span class="pre noprint docinfo"> PROPOSED STANDARD</span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <pre>Internet Engineering Task Force (IETF)                          J. Hedin
Request for Comments: 7750                                     G. Mirsky
Updates: <a href="https://tools.ietf.org/html/rfc5357">5357</a>                                            S.  Baillargeon
Category: Standards Track                                       Ericsson
ISSN: 2070-1721                                            February 2016


 <span class="h1"><h1>Differentiated Service Code Point and Explicit Congestion Notification</h1></span>
     <span class="h1"><h1>Monitoring in the Two-Way Active Measurement Protocol (TWAMP)</h1></span>

Abstract

   This document describes an optional extension for Two-Way Active
   Measurement Protocol (TWAMP) allowing the monitoring of the
   Differentiated Service Code Point and Explicit Congestion
   Notification fields with the TWAMP-Test protocol.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="https://tools.ietf.org/html/rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7750">http://www.rfc-editor.org/info/rfc7750</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Hedin, et al.                Standards Track                    [Page 1]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-2" id="page-2" href="https://tools.ietf.org/html/rfc7750#page-2" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


Table of Contents

   <a href="https://tools.ietf.org/html/rfc7750#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-2">2</a>
     <a href="https://tools.ietf.org/html/rfc7750#section-1.1">1.1</a>.  Conventions Used in This Document . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-3">3</a>
       <a href="https://tools.ietf.org/html/rfc7750#section-1.1.1">1.1.1</a>.  Terminology . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-3">3</a>
       <a href="https://tools.ietf.org/html/rfc7750#section-1.1.2">1.1.2</a>.  Requirements Language . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-3">3</a>
   <a href="https://tools.ietf.org/html/rfc7750#section-2">2</a>.  TWAMP Extensions  . . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-3">3</a>
     <a href="https://tools.ietf.org/html/rfc7750#section-2.1">2.1</a>.  Setting Up Connection to Monitor DSCP and ECN . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-3">3</a>
     <a href="https://tools.ietf.org/html/rfc7750#section-2.2">2.2</a>.  TWAMP-Test Extension  . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-4">4</a>
       2.2.1.  Session-Reflector Packet Format for DSCP and ECN
               Monitoring  . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-4">4</a>
       2.2.2.  DSCP and ECN Monitoring with Extensions from <a href="https://tools.ietf.org/html/rfc6038">RFC 6038</a>   8
       <a href="https://tools.ietf.org/html/rfc7750#section-2.2.3">2.2.3</a>.  Consideration for TWAMP Light Mode  . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-8">8</a>
   <a href="https://tools.ietf.org/html/rfc7750#section-3">3</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-9">9</a>
   <a href="https://tools.ietf.org/html/rfc7750#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-9">9</a>
   <a href="https://tools.ietf.org/html/rfc7750#section-5">5</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-9">9</a>
     <a href="https://tools.ietf.org/html/rfc7750#section-5.1">5.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="https://tools.ietf.org/html/rfc7750#page-9">9</a>
     <a href="https://tools.ietf.org/html/rfc7750#section-5.2">5.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="https://tools.ietf.org/html/rfc7750#page-10">10</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="https://tools.ietf.org/html/rfc7750#page-10">10</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="https://tools.ietf.org/html/rfc7750#page-11">11</a>

<span class="h2"><h2><a class="selflink" name="section-1" href="https://tools.ietf.org/html/rfc7750#section-1">1</a>. Introduction</h2></span>

   The One-Way Active Measurement Protocol (OWAMP) [<a href="https://tools.ietf.org/html/rfc4656" title="&quot;A One-way Active Measurement Protocol (OWAMP)&quot;">RFC4656</a>] defines the
   Type-P Descriptor field and negotiation of its value in the OWAMP-
   Control protocol.  The Two-Way Active Measurement Protocol (TWAMP)
   [<a href="https://tools.ietf.org/html/rfc5357" title="&quot;A Two-Way Active Measurement Protocol (TWAMP)&quot;">RFC5357</a>] states that only a Differentiated Services Code Point
   (DSCP) value (see [<a href="https://tools.ietf.org/html/rfc2474" title="&quot;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers&quot;">RFC2474</a>], [<a href="https://tools.ietf.org/html/rfc3168" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>], and [<a href="https://tools.ietf.org/html/rfc3260" title="&quot;New Terminology and Clarifications for Diffserv&quot;">RFC3260</a>]) can be defined
   by Type-P Descriptor, and the negotiated value must be used by both
   the Session-Sender and Session-Reflector.  The TWAMP specification
   also states that the same DSCP value (found in the Session-Sender
   packet) MUST be used in the test packet reflected by the Session-
   Reflector.  However, the TWAMP-Test protocol does not specify any
   methods to determine or report when the DSCP value has changed or is
   different than expected in the forward or reverse direction.  Re-
   marking the DSCP (changing its original value) in IP networks is
   possible and often accomplished by a Differentiated Services policy
   configured on a single node along the IP path.  In many cases, a
   change of the DSCP value indicates an unintentional or erroneous
   behavior.  At best, the Session-Sender can detect a change of the
   DSCP reverse direction, assuming such a change is actually
   detectable.

   This document describes an OPTIONAL feature for TWAMP.  It is called
   DSCP and ECN Monitoring.  It allows the Session-Sender to know the
   actual DSCP value received at the Session-Reflector.  Furthermore,
   this feature tracks the Explicit Congestion Notification (ECN) value
   (see [<a href="https://tools.ietf.org/html/rfc2474" title="&quot;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers&quot;">RFC2474</a>], [<a href="https://tools.ietf.org/html/rfc3168" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>], and [<a href="https://tools.ietf.org/html/rfc3260" title="&quot;New Terminology and Clarifications for Diffserv&quot;">RFC3260</a>]) received at the Session-



<span class="grey">Hedin, et al.                Standards Track                    [Page 2]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-3" id="page-3" href="https://tools.ietf.org/html/rfc7750#page-3" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   Reflector.  This is helpful to determine if the ECN is actually
   operating or if an ECN-capable node has detected congestion in the
   forward direction.

<span class="h3"><h3><a class="selflink" name="section-1.1" href="https://tools.ietf.org/html/rfc7750#section-1.1">1.1</a>. Conventions Used in This Document</h3></span>

<span class="h4"><h4><a class="selflink" name="section-1.1.1" href="https://tools.ietf.org/html/rfc7750#section-1.1.1">1.1.1</a>. Terminology</h4></span>

   DSCP: Differentiated Services Code Point

   ECN: Explicit Congestion Notification

   IPPM: IP Performance Metrics

   TWAMP: Two-Way Active Measurement Protocol

   OWAMP: One-Way Active Measurement Protocol

<span class="h4"><h4><a class="selflink" name="section-1.1.2" href="https://tools.ietf.org/html/rfc7750#section-1.1.2">1.1.2</a>. Requirements Language</h4></span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   [<a href="https://tools.ietf.org/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><h2><a class="selflink" name="section-2" href="https://tools.ietf.org/html/rfc7750#section-2">2</a>. TWAMP Extensions</h2></span>

   TWAMP connection establishment follows the procedure defined in
   <a href="https://tools.ietf.org/html/rfc4656#section-3.1">Section&nbsp;3.1 of [RFC4656]</a> and <a href="https://tools.ietf.org/html/rfc5357#section-3.1">Section&nbsp;3.1 of [RFC5357]</a> where the Modes
   field is used to identify and select specific communication
   capabilities.  At the same time, the Modes field is recognized and
   used as an extension mechanism [<a href="https://tools.ietf.org/html/rfc6038" title="&quot;Two-Way Active Measurement Protocol (TWAMP) Reflect Octets and Symmetrical Size Features&quot;">RFC6038</a>].  The new feature requires a
   new flag to identify the ability of a Session-Reflector to return the
   values of received DSCP and ECN values back to a Session-Sender, and
   to support the new Session-Reflector packet format in the TWAMP-Test
   protocol.  See <a href="https://tools.ietf.org/html/rfc7750#section-3">Section 3</a> for details on the assigned bit position.

<span class="h3"><h3><a class="selflink" name="section-2.1" href="https://tools.ietf.org/html/rfc7750#section-2.1">2.1</a>. Setting Up Connection to Monitor DSCP and ECN</h3></span>

   The Server sets the DSCP and ECN Monitoring flag in the Modes field
   of the Server Greeting message to indicate its capabilities and
   willingness to monitor them.  If the Control-Client agrees to monitor
   DSCP and ECN on some or all test sessions invoked with this control
   connection, it MUST set the DSCP and ECN Monitoring flag in the Modes
   field in the Setup Response message.






<span class="grey">Hedin, et al.                Standards Track                    [Page 3]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-4" id="page-4" href="https://tools.ietf.org/html/rfc7750#page-4" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


<span class="h3"><h3><a class="selflink" name="section-2.2" href="https://tools.ietf.org/html/rfc7750#section-2.2">2.2</a>. TWAMP-Test Extension</h3></span>

   Monitoring of DSCP and ECN requires support by the Session-Reflector
   and changes the test packet format in all the original modes
   (unauthenticated, authenticated, and encrypted).  Monitoring of DSCP
   and ECN does not alter the Session-Sender test packet format, but
   certain considerations must be taken when and if this mode is
   accepted in combination with Symmetrical Size mode [<a href="https://tools.ietf.org/html/rfc6038" title="&quot;Two-Way Active Measurement Protocol (TWAMP) Reflect Octets and Symmetrical Size Features&quot;">RFC6038</a>].

<span class="h4"><h4><a class="selflink" name="section-2.2.1" href="https://tools.ietf.org/html/rfc7750#section-2.2.1">2.2.1</a>. Session-Reflector Packet Format for DSCP and ECN Monitoring</h4></span>

   When the Session-Reflector supports DSCP and ECN Monitoring, it
   constructs the Sender DSCP and ECN (S-DSCP-ECN) field, presented in
   Figure 1, for each test packet it sends to the Session-Sender
   according to the following procedure:

   o  the six (least-significant) bits of the Differentiated Service
      field MUST be copied from the received Session-Sender test packet
      into the Sender DSCP (S-DSCP) field;

   o  the two bits of the ECN field MUST be copied from the received
      Session-Sender test packet into the Sender ECN (S-ECN) field.

      0   1   2   3   4   5   6   7
    +---+---+---+---+---+---+---+---+
    |         S-DSCP        | S-ECN |
    +---+---+---+---+---+---+---+---+

                Figure 1: Sender DSCP and ECN Field Format

   Formats of the test packet transmitted by the Session-Reflector in
   unauthenticated, authenticated, and encrypted modes have been defined
   in <a href="https://tools.ietf.org/html/rfc5357#section-4.2.1">Section&nbsp;4.2.1 of [RFC5357]</a>.  For the Session-Reflector that
   supports DSCP and ECN Monitoring, these formats are displayed in
   Figures 2 and 3.
















<span class="grey">Hedin, et al.                Standards Track                    [Page 4]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-5" id="page-5" href="https://tools.ietf.org/html/rfc7750#page-5" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   For unauthenticated mode:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Sequence Number                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Error Estimate         |             MBZ                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Receive Timestamp                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  Sender Sequence Number                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Sender Timestamp                          |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Sender Error Estimate      |             MBZ               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Sender TTL    |  S-DSCP-ECN   |             MBZ               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                        Packet Padding                         ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

     Figure 2: Session-Reflector Test Packet Format with DSCP and ECN
                    Monitoring in Unauthenticated Mode

   The DSCP and ECN values (part of the Type-P Descriptor [<a href="https://tools.ietf.org/html/rfc4656" title="&quot;A One-way Active Measurement Protocol (OWAMP)&quot;">RFC4656</a>]) can
   be provisioned through TWAMP-Control or by other means (command-line
   interface (CLI) or Central Controller).  The DSCP and ECN values are
   often copied into reflected test packets with current TWAMP
   implementations without TWAMP-Control protocol.  With the DSCP and
   ECN Monitoring extension, the Session-Reflector handles the DSCP as
   follows:

   o  the Session-Reflector MUST extract the DSCP and ECN values from
      the received packet and MUST use them to populate the S-DSCP-ECN
      field of the corresponding reflected packet;

   o  the Session-Reflector MUST transmit each reflected test packet
      with the DSCP set to the provisioned value;





<span class="grey">Hedin, et al.                Standards Track                    [Page 5]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-6" id="page-6" href="https://tools.ietf.org/html/rfc7750#page-6" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   o  if the provisioned DSCP value is not known (e.g., TWAMP Light),
      the choice of the DSCP is implementation specific.  For instance,
      the Session-Reflector MAY copy the DSCP value from the received
      test packet and set it as the DSCP in a reflected packet.
      Alternatively, the Session-Reflector MAY set the DSCP value to CS0
      (zero) [<a href="https://tools.ietf.org/html/rfc2474" title="&quot;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers&quot;">RFC2474</a>];

   o  if the provisioned ECN value is not known, ECN SHOULD be set to
      Not-ECT codepoint value [<a href="https://tools.ietf.org/html/rfc3168" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>].  Otherwise, the provisioned ECN
      value for the session SHALL be used.

   A Session-Reflector in the DSCP and ECN Monitoring mode does not
   analyze nor act on the ECN value of the received TWAMP test packet;
   therefore, it ignores congestion indications from the network.  It is
   expected that sending rates are low enough, as TWAMP deployment
   experience had demonstrated since TWAMP base (<a href="https://tools.ietf.org/html/rfc5357">RFC 5357</a>) was published
   in 2008, that ignoring these congestion indications will not
   significantly contribute to network congestion.

   For authenticated and encrypted modes:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Sequence Number                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                       MBZ (12 octets)                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Timestamp                             |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Error Estimate          |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                        MBZ (6 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Receive Timestamp                        |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       MBZ (8 octets)                          |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   Sender Sequence Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                      MBZ (12 octets)                          |
   |                                                               |



<span class="grey">Hedin, et al.                Standards Track                    [Page 6]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-7" id="page-7" href="https://tools.ietf.org/html/rfc7750#page-7" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Sender Timestamp                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |    Sender Error Estimate      |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                         MBZ (6 octets)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Sender TTL    |  S-DSCP-ECN   |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                                                               |
   |                         MBZ (14 octets)                       |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                        HMAC (16 octets)                       |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                       Packet Padding                          ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

     Figure 3: Session-Reflector Test Packet Format with DSCP and ECN
              Monitoring in Authenticated or Encrypted Modes

























<span class="grey">Hedin, et al.                Standards Track                    [Page 7]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-8" id="page-8" href="https://tools.ietf.org/html/rfc7750#page-8" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


<span class="h4"><h4><a class="selflink" name="section-2.2.2" href="https://tools.ietf.org/html/rfc7750#section-2.2.2">2.2.2</a>. DSCP and ECN Monitoring with Extensions from <a href="https://tools.ietf.org/html/rfc6038">RFC 6038</a></h4></span>

   [<a name="ref-RFC6038" id="ref-RFC6038">RFC6038</a>] defined two extensions to TWAMP -- first, to ensure that
   the Session-Sender and Session-Reflector exchange TWAMP-Test packets
   of equal size; second, to specify the number of octets to be
   reflected by Session-Reflector.  If DSCP and ECN Monitoring and
   Symmetrical Size and/or Reflects Octets modes are being negotiated
   between Server and Control-Client in Unauthenticated mode, then,
   because Sender DSCP and Sender ECN increase the size of the
   unauthenticated Session-Reflector packet by 4 octets, the Padding
   Length value SHOULD be greater than or equal to 28 octets to allow
   for the truncation process that TWAMP recommends in <a href="https://tools.ietf.org/html/rfc5357#section-4.2.1">Section&nbsp;4.2.1 of
   [RFC5357]</a>.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Timestamp                           |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                                                               |
   |                         MBZ (28 octets)                       |
   |                                                               |
   +                             +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             |                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                                 +
   |                                                               |
   .                                                               .
   .                        Packet Padding                         .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 4: Session-Sender Test Packet Format with DSCP and ECN
      Monitoring and Symmetrical Test Packet in Unauthenticated Mode

<span class="h4"><h4><a class="selflink" name="section-2.2.3" href="https://tools.ietf.org/html/rfc7750#section-2.2.3">2.2.3</a>. Consideration for TWAMP Light Mode</h4></span>

   <a href="https://tools.ietf.org/html/rfc5357#appendix-I">Appendix&nbsp;I of [RFC5357]</a> does not explicitly state how the value of
   the Type-P Descriptor is synchronized between the Session-Sender and
   Session-Reflector and whether different values are considered as
   error conditions and should be reported.  We assume that by some
   means the Session-Sender and the Session-Reflector of the given
   TWAMP-Test session have been informed to use the same DSCP value.
   The same means, i.e., configuration, could be used to inform the



<span class="grey">Hedin, et al.                Standards Track                    [Page 8]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-9" id="page-9" href="https://tools.ietf.org/html/rfc7750#page-9" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   Session-Reflector to support DSCP and ECN Monitoring mode by copying
   data from received TWAMP test packets.  Then Session-Sender may be
   informed to use the Sender DSCP and ECN field in the reflected TWAMP
   test packet.

<span class="h2"><h2><a class="selflink" name="section-3" href="https://tools.ietf.org/html/rfc7750#section-3">3</a>. IANA Considerations</h2></span>

   In the TWAMP-Modes registry defined in [<a href="https://tools.ietf.org/html/rfc5618" title="&quot;Mixed Security Mode for the Two-Way Active Measurement Protocol (TWAMP)&quot;">RFC5618</a>], IANA has reserved a
   new DSCP and ECN Monitoring Capability as follows:

   +-----+---------------------------+---------------------+-----------+
   | Bit | Description               | Semantics           | Reference |
   | Pos |                           | Definition          |           |
   +-----+---------------------------+---------------------+-----------+
   | 8   | DSCP and ECN Monitoring   | <a href="https://tools.ietf.org/html/rfc7750#section-2">Section 2</a>           | <a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>  |
   |     | Capability                |                     |           |
   +-----+---------------------------+---------------------+-----------+

           Table 1: New Type-P Descriptor Monitoring Capability

<span class="h2"><h2><a class="selflink" name="section-4" href="https://tools.ietf.org/html/rfc7750#section-4">4</a>. Security Considerations</h2></span>

   Monitoring of DSCP and ECN does not appear to introduce any
   additional security threat to hosts that communicate with TWAMP as
   defined in [<a href="https://tools.ietf.org/html/rfc5357" title="&quot;A Two-Way Active Measurement Protocol (TWAMP)&quot;">RFC5357</a>] and existing extensions [<a href="https://tools.ietf.org/html/rfc6038" title="&quot;Two-Way Active Measurement Protocol (TWAMP) Reflect Octets and Symmetrical Size Features&quot;">RFC6038</a>].  Sections
   such as 3.2, 4, 4.1.2, 4.2, and 4.2.1 of [<a href="https://tools.ietf.org/html/rfc5357" title="&quot;A Two-Way Active Measurement Protocol (TWAMP)&quot;">RFC5357</a>] discuss
   unauthenticated, authenticated, and encrypted modes in varying
   degrees of detail.  The security considerations that apply to any
   active measurement of live networks are relevant here as well.  See
   the Security Considerations sections in [<a href="https://tools.ietf.org/html/rfc4656" title="&quot;A One-way Active Measurement Protocol (OWAMP)&quot;">RFC4656</a>] and [<a href="https://tools.ietf.org/html/rfc5357" title="&quot;A Two-Way Active Measurement Protocol (TWAMP)&quot;">RFC5357</a>].

<span class="h2"><h2><a class="selflink" name="section-5" href="https://tools.ietf.org/html/rfc7750#section-5">5</a>. References</h2></span>

<span class="h3"><h3><a class="selflink" name="section-5.1" href="https://tools.ietf.org/html/rfc7750#section-5.1">5.1</a>. Normative References</h3></span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a name="ref-RFC2474" id="ref-RFC2474">RFC2474</a>]  Nichols, K., Blake, S., Baker, F., and D. Black,
              &quot;Definition of the Differentiated Services Field (DS
              Field) in the IPv4 and IPv6 Headers&quot;, <a href="https://tools.ietf.org/html/rfc2474">RFC 2474</a>,
              DOI 10.17487/RFC2474, December 1998,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2474">http://www.rfc-editor.org/info/rfc2474</a>&gt;.






<span class="grey">Hedin, et al.                Standards Track                    [Page 9]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-10" id="page-10" href="https://tools.ietf.org/html/rfc7750#page-10" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


   [<a name="ref-RFC3168" id="ref-RFC3168">RFC3168</a>]  Ramakrishnan, K., Floyd, S., and D. Black, &quot;The Addition
              of Explicit Congestion Notification (ECN) to IP&quot;,
              <a href="https://tools.ietf.org/html/rfc3168">RFC 3168</a>, DOI 10.17487/RFC3168, September 2001,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3168">http://www.rfc-editor.org/info/rfc3168</a>&gt;.

   [<a name="ref-RFC4656" id="ref-RFC4656">RFC4656</a>]  Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M.
              Zekauskas, &quot;A One-way Active Measurement Protocol
              (OWAMP)&quot;, <a href="https://tools.ietf.org/html/rfc4656">RFC 4656</a>, DOI 10.17487/RFC4656, September 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4656">http://www.rfc-editor.org/info/rfc4656</a>&gt;.

   [<a name="ref-RFC5357" id="ref-RFC5357">RFC5357</a>]  Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J.
              Babiarz, &quot;A Two-Way Active Measurement Protocol (TWAMP)&quot;,
              <a href="https://tools.ietf.org/html/rfc5357">RFC 5357</a>, DOI 10.17487/RFC5357, October 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5357">http://www.rfc-editor.org/info/rfc5357</a>&gt;.

   [<a name="ref-RFC5618" id="ref-RFC5618">RFC5618</a>]  Morton, A. and K. Hedayat, &quot;Mixed Security Mode for the
              Two-Way Active Measurement Protocol (TWAMP)&quot;, <a href="https://tools.ietf.org/html/rfc5618">RFC 5618</a>,
              DOI 10.17487/RFC5618, August 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5618">http://www.rfc-editor.org/info/rfc5618</a>&gt;.

   [<a name="ref-RFC6038" id="ref-RFC6038">RFC6038</a>]  Morton, A. and L. Ciavattone, &quot;Two-Way Active Measurement
              Protocol (TWAMP) Reflect Octets and Symmetrical Size
              Features&quot;, <a href="https://tools.ietf.org/html/rfc6038">RFC 6038</a>, DOI 10.17487/RFC6038, October 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6038">http://www.rfc-editor.org/info/rfc6038</a>&gt;.

<span class="h3"><h3><a class="selflink" name="section-5.2" href="https://tools.ietf.org/html/rfc7750#section-5.2">5.2</a>. Informative References</h3></span>

   [<a name="ref-RFC3260" id="ref-RFC3260">RFC3260</a>]  Grossman, D., &quot;New Terminology and Clarifications for
              Diffserv&quot;, <a href="https://tools.ietf.org/html/rfc3260">RFC 3260</a>, DOI 10.17487/RFC3260, April 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3260">http://www.rfc-editor.org/info/rfc3260</a>&gt;.

Acknowledgements

   The authors greatly appreciate thorough review and thoughtful
   comments by Bill Cerveny, Christofer Flinta, and Samita Chakrabarti.
















<span class="grey">Hedin, et al.                Standards Track                   [Page 10]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-11" id="page-11" href="https://tools.ietf.org/html/rfc7750#page-11" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc7750">RFC 7750</a>            DSCP and ECN Monitoring in TWAMP       February 2016</span>


Authors' Addresses

   Jonas Hedin
   Ericsson

   Email: jonas.hedin@ericsson.com


   Greg Mirsky
   Ericsson

   Email: gregory.mirsky@ericsson.com


   Steve  Baillargeon
   Ericsson

   Email: steve.baillargeon@ericsson.com

































Hedin, et al.                Standards Track                   [Page 11]

</pre>
   <br /> 
   <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a> </small></small></span> 
  </div> 
 </body>
</html>