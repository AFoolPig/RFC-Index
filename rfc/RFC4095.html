<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head profile="http://dublincore.org/documents/2008/08/04/dc-html/"> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta name="robots" content="index,follow" /> 
  <meta name="creator" content="rfcmarkup version 1.127" /> 
  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" /> 
  <meta name="DC.Identifier" content="urn:ietf:rfc:4095" /> 
  <meta name="DC.Description.Abstract" content="This document proposes a mechanism for finding a URI associated with a
solicitation class keyword, which is defined in RFC 3865, the No
Soliciting SMTP Service Extension. Solicitation class keywords are
simple labels consisting of a domain name that has been reversed, such
as &quot;org.example.adv&quot;. These solicitation class keywords are inserted
in selected header fields or used in the ESMTP service extension,
including a new \%&quot;No-Solicit:&quot; header, which can contain one or more
solicitation class keywords inserted by the sender.  This document
specifies an application based on the Dynamic Delegation Discovery
System (DDDS) described in RFC 3401 and related documents. An
algorithm is specified to associate a solicitation class keyword with
a URI which contains further information about the meaning and usage
of that solicitation class keyword. For example, the registrant of the
&quot;example.org&quot; domain could use this mechanism to create a URI which
contains detailed information about the &quot;org.example.adv&quot; solicitation
class keyword. [STANDARDS-TRACK]" /> 
  <meta name="DC.Creator" content="Carl Malamud &lt;carl@media.org&gt;" /> 
  <meta name="DC.Date.Issued" content="May, 2005" /> 
  <meta name="DC.Title" content="Attaching Meaning to Solicitation Class Keywords" /> 
  <link rel="icon" href="/images/rfc.png" type="image/png" /> 
  <link rel="shortcut icon" href="/images/rfc.png" type="image/png" /> 
  <title>RFC 4095 - Attaching Meaning to Solicitation Class Keywords</title> 
  <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style> 
  <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> 
  <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script> 
 </head> 
 <body onload="addHeaderTags()"> 
  <div class="content"> 
   <div style="height: 13px;"> 
    <div onmouseover="this.style.cursor='pointer';" onclick="showElem('legend');" onmouseout="hideElem('legend')" style="height: 6px; position: absolute;" class="pre noprint docinfo bgblue" title="Click for colour legend."> 
    </div> 
    <div id="legend" class="docinfo noprint pre legend" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; " onmouseover="showElem('legend');" onmouseout="hideElem('legend');"> 
    </div> 
   </div> 
   <span class="pre noprint docinfo top">[<a href="https://tools.ietf.org/html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4095.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4095" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-malamud-keyword-discovery" title="draft-malamud-keyword-discovery">draft-malamud-k...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4095" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4095" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4095" title="Side-by-side diff">Diff2</a>] </span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <span class="pre noprint docinfo"> PROPOSED STANDARD</span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <pre>Network Working Group                                         C. Malamud
Request for Comments: 4095                           Memory Palace Press
Category: Standards Track                                       May 2005


            <span class="h1"><h1>Attaching Meaning to Solicitation Class Keywords</h1></span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document proposes a mechanism for finding a URI associated with
   a solicitation class keyword, which is defined in <a href="https://tools.ietf.org/html/rfc3865">RFC 3865</a>, the No
   Soliciting SMTP Service Extension.  Solicitation class keywords are
   simple labels consisting of a domain name that has been reversed,
   such as &quot;org.example.adv&quot;.  These solicitation class keywords are
   inserted in selected header fields or used in the ESMTP service
   extension, including a new &quot;No-Solicit:&quot; header, which can contain
   one or more solicitation class keywords inserted by the sender.

   This document specifies an application based on the Dynamic
   Delegation Discovery System (DDDS) described in <a href="https://tools.ietf.org/html/rfc3401">RFC 3401</a> and related
   documents.  An algorithm is specified to associate a solicitation
   class keyword with a URI which contains further information about the
   meaning and usage of that solicitation class keyword.  For example,
   the registrant of the &quot;example.org&quot; domain could use this mechanism
   to create a URI which contains detailed information about the
   &quot;org.example.adv&quot; solicitation class keyword.













<span class="grey">Malamud                     Standards Track                     [Page 1]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-2" id="page-2" href="https://tools.ietf.org/html/rfc4095#page-2" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


Table of Contents

   <a href="https://tools.ietf.org/html/rfc4095#section-1">1</a>. Solicitation Class Keywords .....................................<a href="https://tools.ietf.org/html/rfc4095#page-2">2</a>
      <a href="https://tools.ietf.org/html/rfc4095#section-1.1">1.1</a>. Terminology ................................................<a href="https://tools.ietf.org/html/rfc4095#page-3">3</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-2">2</a>. The No-Solicit NAPTR Application ................................<a href="https://tools.ietf.org/html/rfc4095#page-3">3</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-3">3</a>. Example .........................................................<a href="https://tools.ietf.org/html/rfc4095#page-5">5</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-4">4</a>. DDDS Application Specification ..................................<a href="https://tools.ietf.org/html/rfc4095#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-5">5</a>. Acknowledgements ................................................<a href="https://tools.ietf.org/html/rfc4095#page-8">8</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-6">6</a>. Security Considerations .........................................<a href="https://tools.ietf.org/html/rfc4095#page-8">8</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-7">7</a>. IANA Considerations .............................................<a href="https://tools.ietf.org/html/rfc4095#page-9">9</a>
   <a href="https://tools.ietf.org/html/rfc4095#section-8">8</a>. References ......................................................<a href="https://tools.ietf.org/html/rfc4095#page-9">9</a>
      <a href="https://tools.ietf.org/html/rfc4095#section-8.1">8.1</a>. Normative References .......................................<a href="https://tools.ietf.org/html/rfc4095#page-9">9</a>
      <a href="https://tools.ietf.org/html/rfc4095#section-8.2">8.2</a>. Informative References ....................................<a href="https://tools.ietf.org/html/rfc4095#page-10">10</a>

<span class="h2"><h2><a class="selflink" name="section-1" href="https://tools.ietf.org/html/rfc4095#section-1">1</a>. Solicitation Class Keywords</h2></span>

   [<a name="ref-RFC3865" id="ref-RFC3865">RFC3865</a>] defines the concept of a &quot;solicitation class keyword&quot;,
   which is an arbitrary string or label which can be associated with an
   electronic mail message and transported by the ESMTP mail service as
   defined in [<a href="https://tools.ietf.org/html/rfc2821" title="&quot;Simple Mail Transfer Protocol&quot;">RFC2821</a>] and related documents.  Solicitation class
   keywords are formatted like domain names, but reversed.  For example,
   the zone administrator of &quot;example.com&quot; might specify a particular
   solicitation class keyword such as &quot;com.example.adv&quot; that could be
   inserted in a &quot;No-Solicit:&quot; header by the message sender or in a
   trace field by a message transfer agent (MTA).  This solicitation
   class keyword is inserted by the sender of the message, who may also
   insert a variety of other solicitation class keywords as defined by
   the sender or by other parties.

   [<a name="ref-RFC3865" id="ref-RFC3865">RFC3865</a>] explicitly places discovery of the meaning of a
   solicitation class keyword as outside of the scope of the basic ESMTP
   service extension.  For the purposes of message transport, these
   solicitation class keywords are opaque.  However, if <a href="https://tools.ietf.org/html/rfc3865">RFC 3865</a> becomes
   widely used, a mail message might contain a large number of
   solicitation class keywords.  The &quot;No-Solicit:&quot; header has keywords
   inserted by the sender of the message, which might include the
   sender's own keywords, as well as those mandated by regulatory
   authorities or recommended by voluntary industry associations.
   Likewise, the &quot;received:&quot; trace fields might contain a large number
   of keywords produced by message transfer agents, filtering software,
   forwarding software in the message user agent (MUA), or any other
   system in the chain of delivery.

   As the number of keywords employed grows, it will be important to
   find a method for discovering the meaning behind the various
   solicitation class keywords.  This document specifies such a
   mechanism, associating a solicitation class keyword with a URI which
   contains further information by using the DNS NAPTR Resource Record,



<span class="grey">Malamud                     Standards Track                     [Page 2]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-3" id="page-3" href="https://tools.ietf.org/html/rfc4095#page-3" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   which is defined in [<a href="https://tools.ietf.org/html/rfc3403" title="&quot;Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database&quot;">RFC3403</a>].  An explicit design goal is to keep
   the system as simple as possible.  Approaches such as defining an
   XML-based structure that would contain specific meta-data about the
   solicitation class keyword or other approaches that define the format
   of the explanation were ruled out.  Instead, the goal is to simply to
   associate a solicitation class keyword with a URI, which in turn
   contains an explanation of the keyword.

<span class="h3"><h3><a class="selflink" name="section-1.1" href="https://tools.ietf.org/html/rfc4095#section-1.1">1.1</a>. Terminology</h3></span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, [<a href="https://tools.ietf.org/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><h2><a class="selflink" name="section-2" href="https://tools.ietf.org/html/rfc4095#section-2">2</a>. The No-Solicit NAPTR Application</h2></span>

   The DDDS framework of [<a href="https://tools.ietf.org/html/rfc3401" title="&quot;Dynamic Delegation Discovery System (DDDS) Part One: The Comprehensive DDDS&quot;">RFC3401</a>] and related documents provides a
   powerful set of mechanisms that can yield sophisticated applications
   such as ENUM as specified in [<a href="https://tools.ietf.org/html/rfc3761" title="&quot;The E.164 to Uniform Resource Identifiers (URI) Dynamic Delegation Discovery System (DDDS) Application (ENUM)&quot;">RFC3761</a>].  There is a simplification of
   the DDDS framework called the Straightforward-NAPTR (S-NAPTR)
   application as specified in [<a href="https://tools.ietf.org/html/rfc3958" title="&quot;Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)&quot;">RFC3958</a>].  Unfortunately, S-NAPTR does
   not permit the use of the &quot;U&quot; flag for terminal lookups and does not
   support the regular expression field of the NAPTR RR.  Since a
   replacement field in a NAPTR record must contain only a domain name,
   and our goal is to find a URI, this document does not use the S-NAPTR
   mechanism.

   This document uses the NAPTR RR to do a single lookup from
   solicitation class keyword to URI.  The character &quot;.&quot; is first
   substituted for any instances of the character &quot;:&quot; and then the
   solicitation class keyword is reversed, using the character &quot;.&quot; as
   the delimiter.  This becomes the domain name lookup key.  For
   example, &quot;org.example:ADV&quot; becomes &quot;ADV.example.org&quot;.

   Note On Domain Names: <a href="https://tools.ietf.org/html/rfc3865">RFC3865</a> states that a solicitation class
   keyword consists of a valid domain name followed by the &quot;:&quot;
   character and by additional valid characters.  Several points are
   important to remember for implementors.  Since domain names are case
   insensitive and the &quot;:&quot; character is translated to the &quot;.&quot;
   character, for purposes of this DDDS application, the following
   solicitation class keywords are syntactically equivalent:
   &quot;com.example:ADV&quot;, &quot;com.Example:adv&quot;, and &quot;com:example:ADV&quot;.

   In addition, it is important to remember that the resulting string
   must meet other DNS validity checks.  In particular, domain labels
   are limited to 63 characters in length and the total length of the
   resulting string must be less than 253 characters.  Any non-ASCII




<span class="grey">Malamud                     Standards Track                     [Page 3]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-4" id="page-4" href="https://tools.ietf.org/html/rfc4095#page-4" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   characters must be encoded using the Internationalized Domain Names
   (IDN) specifications in [<a href="https://tools.ietf.org/html/rfc3490" title="&quot;Internationalizing Domain Names in Applications (IDNA)&quot;">RFC3490</a>] and related documents.  Note that
   non-ASCII characters may be encoded after the &quot;:&quot; character as well.

   The fields of the NAPTR RR are used as follows:

   o  The &quot;ORDER&quot; and &quot;PREFERENCE&quot; fields are to be processed as
      specified in [<a href="https://tools.ietf.org/html/rfc3403" title="&quot;Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database&quot;">RFC3403</a>]: if multiple records are returned, the
      one(s) with the lowest &quot;ORDER&quot; value that have a matching
      &quot;SERVICE&quot; field MUST be used.  Of those with the lowest ORDER
      value, those with the lowest &quot;PREFERENCE&quot; SHOULD be used.

   o  The &quot;FLAGS&quot; field MUST contain the character &quot;U&quot;.

   o  The &quot;SERVICES&quot; field MUST contain only the string &quot;no-solicit&quot;.

   o  The &quot;REGEXP&quot; field MUST contain a valid URI as further specified
      in this section.

   o  The &quot;REPLACEMENT&quot; field MUST be empty.

   The &quot;REGEXP&quot; field is defined in [<a href="https://tools.ietf.org/html/rfc3402" title="&quot;Dynamic Delegation Discovery System (DDDS) Part Two: The Algorithm&quot;">RFC3402</a>] as consisting of a
   &quot;delim-character&quot;, a POSIX Extended Regular Expression, another
   &quot;delim-character&quot;, a replacement value, and a final
   &quot;delim-character&quot;.  For this application the following rules apply:

   o  The &quot;delim-character&quot; MAY be any valid character as defined in
      <a href="https://tools.ietf.org/html/rfc3402#section-3.2">section&nbsp;3.2 of [RFC3402]</a>.

   o  The extended regular expression MUST be empty.

   o  The replacement value MUST contain a valid URI as specified in
      [<a href="https://tools.ietf.org/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>].

   o  The replacement value SHOULD contain a URI limited to the &quot;ftp&quot;,
      &quot;http&quot;, and &quot;https&quot; schemes as specified in [<a href="https://tools.ietf.org/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>] and
      [<a href="https://tools.ietf.org/html/rfc2660" title="&quot;The Secure HyperText Transfer Protocol&quot;">RFC2660</a>].

   o  The document that is retrieved at the URI SHOULD conform to
      [<a href="https://tools.ietf.org/html/rfc4095#ref-HTML-4.01" title="&quot;HTML 4.01 Specification&quot;">HTML-4.01</a>], including the Accessibility Guidelines contained
      therein.










<span class="grey">Malamud                     Standards Track                     [Page 4]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-5" id="page-5" href="https://tools.ietf.org/html/rfc4095#page-5" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


<span class="h2"><h2><a class="selflink" name="section-3" href="https://tools.ietf.org/html/rfc4095#section-3">3</a>. Example</h2></span>

   In this example, a set of NAPTR records are added to the
   &quot;example.com&quot; zone and can be retrieved using &quot;dig&quot; or other DNS
   utilities:

   [carl@example.com]% dig 2795.example.com naptr

   ; &lt;&lt;&gt;&gt; DiG 9.2.3 &lt;&lt;&gt;&gt; 2795.example.com naptr
   ;; global options:  printcmd
   ;; Got answer:
   ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY,
      status: NOERROR, id: 43494
   ;; flags: qr aa rd ra; QUERY: 1, ANSWER: 5,
      AUTHORITY: 2, ADDITIONAL: 1

   ;; QUESTION SECTION:
   ;2795.example.com.              IN      NAPTR

   ;; ANSWER SECTION:
   2795.example.com.       86400   IN
        NAPTR   1 1 &quot;U&quot; &quot;iam+invalid&quot;
        &quot;!!http://invalid.example.com/contact.html!&quot; .
   2795.example.com.       86400   IN
        NAPTR   1 1 &quot;U&quot; &quot;sip+invalid&quot;
        &quot;!!http://invalid.example.com/contact.html!&quot; .
   2795.example.com.       86400   IN
        NAPTR   1 2 &quot;U&quot; &quot;no-solicit&quot;
        &quot;!!http://infinite.example.com/keywordinfo.html!&quot; .
   2795.example.com.       86400   IN
        NAPTR   2 1 &quot;U&quot; &quot;no-solicit&quot;
        &quot;!!http://infinite.example.com/keywordinfo.html!&quot; .
   2795.example.com.       86400   IN
        NAPTR   1 1 &quot;U&quot; &quot;no-solicit&quot;
        &quot;!!http://infinite.example.com/keywordinfo.html!&quot; .
















<span class="grey">Malamud                     Standards Track                     [Page 5]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-6" id="page-6" href="https://tools.ietf.org/html/rfc4095#page-6" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   A simple utility written in PERL accepts a lookup key and returns a
   URI using the specifications in this document.  This example is
   non-normative:

   #!/usr/bin/perl

   # THIS SAMPLE CODE IS NOT NORMATIVE

   # This program accepts a solicitation class keyword and
   # returns a URI on success.  It dies quietly on failure.
   use strict;

   # <a href="http://www.net-dns.org/use">http://www.net-dns.org/</a>
   <a href="http://www.net-dns.org/use">use</a> Net::DNS;

   # reverse the label to create a domain name
   $ARGV[0] =~ tr/:/./ ;
   my $target = join( &quot;.&quot;, reverse( split( /\./, $ARGV[0] ) ) );

   # create a resolver
   my $res = Net::DNS::Resolver-&gt;new;

   # find all naptr records
   my $query = $res-&gt;query( &quot;$target&quot;, &quot;NAPTR&quot; ) || exit ;

   # Do your DNSSEC checks here, throw away all invalid RRs

   # get the answers, strip out non-matching services,
   # sort by order, preference
   my @rr =
     sort {
       # sort records numerically by order, preference
       $a-&gt;order &lt;=&gt; $b-&gt;order
         || $a-&gt;preference &lt;=&gt; $b-&gt;preference
     }
     grep { $_-&gt;service =~ /no-solicit/ } $query-&gt;answer;

   # print the first qualifying record, strip out the
   # regexp markers
   my $op = substr( my $answer = $rr[0]-&gt;regexp , 0, 1 )
      || exit ;
   print split ( $op, $answer ) ; exit ;









<span class="grey">Malamud                     Standards Track                     [Page 6]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-7" id="page-7" href="https://tools.ietf.org/html/rfc4095#page-7" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   Running the sample code gives the following results:

   [carl@example.com]% lynx -source `./discover.pl com.example.2795`
   &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
   &lt;html&gt;
     &lt;head&gt;
       &lt;title&gt;About Our Solicitation Class Keyword&lt;/title&gt;
     &lt;/head&gt;
     &lt;body&gt;
       &lt;center&gt;
         &lt;a href=&quot;monkey.mp3&quot;&gt;
           &lt;img alt=&quot;bouncy monkey logo&quot;
                src=&quot;images/monkey_fpo.gif&quot; border=&quot;0&quot; /&gt;
           &lt;br /&gt;
          &lt;/a&gt;
          &lt;br /&gt;
          About com.example.2795:&lt;br /&gt;
          It has been determined that the content of this
          mail message&lt;br /&gt;
          conforms to the spirit of <a href="https://tools.ietf.org/html/rfc2795">RFC 2795</a>.
          Congratulations?
       &lt;/center&gt;
     &lt;/body&gt;
   &lt;/html&gt;

<span class="h2"><h2><a class="selflink" name="section-4" href="https://tools.ietf.org/html/rfc4095#section-4">4</a>. DDDS Application Specification</h2></span>

   The following definitions apply to this application:

   o  Application Unique String: The application unique string is a
      Solicitation Class Keyword as defined in [<a href="https://tools.ietf.org/html/rfc3865" title="&quot;A No Soliciting Simple Mail Transfer Protocol (SMTP) Service Extension&quot;">RFC3865</a>].
   o  First Well Known Rule: The character &quot;.&quot; is substituted for the
      character &quot;:&quot; and then the Solicitation Class Keyword is reversed
      in order to produce a valid domain name.  For example,
      &quot;com.example:adv&quot; would become &quot;adv.example.com&quot;.
   o  Valid Databases: The DNS _is_ the database.
   o  Expected Output: A URI.
   o  The &quot;SERVICE&quot; field MUST contain the string &quot;no-solicit&quot;, the
      &quot;FLAGS&quot; field MUST contain the string &quot;U&quot;, the &quot;REPLACEMENT&quot; field
      MUST be empty, and the &quot;REGEXP&quot; field MUST be formatted as
      specified in <a href="https://tools.ietf.org/html/rfc4095#section-2">Section 2</a>.

   Wildcards are appropriate for this application, allowing multiple
   solicitation class keywords that share a common prefix to all point
   to the same URI.  Note that the NAPTR Resource Record is known as a
   &quot;subtyping&quot; RR, which means that additional selectors are available
   within the RR to &quot;winnow down&quot; the choices.  This means more records
   are returned than are actually needed, resulting in more traffic.



<span class="grey">Malamud                     Standards Track                     [Page 7]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-8" id="page-8" href="https://tools.ietf.org/html/rfc4095#page-8" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   But, this also means that wildcards may have unintended effects of
   multiple types of NAPTR resource records are used.  Implementors and
   zone administrators should exercise care in the use of such wildcards
   in this application.

<span class="h2"><h2><a class="selflink" name="section-5" href="https://tools.ietf.org/html/rfc4095#section-5">5</a>. Acknowledgements</h2></span>

   The author would like to thank the following for their helpful
   suggestions and reviews of this document: Leslie Daigle, Spencer
   Dawkins, Arnt Gulbrandsen, Ted Hardie, Scott Hollenbeck, Russ
   Housley, David Kessens, Peter Koch, Michael Mealling, Pekka Savola,
   Mark Townsley, and Margaret Wasserman.

<span class="h2"><h2><a class="selflink" name="section-6" href="https://tools.ietf.org/html/rfc4095#section-6">6</a>. Security Considerations</h2></span>

   This document specifies an application which depends on the Domain
   Name System to associate a solicitation class keyword with a URI.
   Four security considerations are raised by this application:

   1.  If the domain name lookup has been compromised, the application
       may return a URI with incorrect guidance on the use of a
       particular solicitation class keyword.  In particular, if the
       application returns a URI with the &quot;https:&quot; scheme, and the DNS
       Security Extensions as defined in [<a href="https://tools.ietf.org/html/rfc4033" title="&quot;DNS Security Introduction and Requirements&quot;">RFC4033</a>] and related documents
       are not used, the user would have an unwarranted illusion of
       authenticity making the possibility of active attacks a serious
       concern.  Even if both DNS Security Extensions and the &quot;https:&quot;
       scheme are used, the client will need to take additional steps to
       ensure that the two different digital signature validation
       contexts are being administered by the same domain owner.

   2.  <a href="https://tools.ietf.org/html/rfc3865">RFC 3865</a> bases solicitation class keywords on domain names.
       However, it does not define whom a user should trust.  A sender
       or an intermediate MTA could insert a solicitation class keyword
       in a message and then use the application defined in this
       document to mislead the message recipient.  For example, a
       malicious direct marketer might insert a keyword such as
       &quot;org.example.certified.message&quot; and use a URI to somehow indicate
       that the message (wrongly) has some official status.  As with any
       URI, users must take further steps that are outside the scope of
       this specification to determine what and whom to believe.

   3.  Domain names are not persistent identifiers.  As with any
       application that uses domain names, including the World Wide Web,
       if a domain name or a URI is embedded in an electronic mail
       message, there is a possibility that in the future the domain
       name will be controlled by a different zone administrator and
       that



<span class="grey">Malamud                     Standards Track                     [Page 8]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-9" id="page-9" href="https://tools.ietf.org/html/rfc4095#page-9" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


       use of the application described in this document will yield
       different and possibly inconsistent results over time.

   4.  A malicious sender could insert a large number of solicitation
       class keywords or improperly formatted solicitation keywords,
       thus performing a Denial of Service attack on the recipient's
       resources through the use of an excessive number of DNS lookups.
       If such a message is sent to many recipients, this can result in
       a Denial of Service attack on the provider at a particular URI
       (e.g., a large number of requests attempting to access a URI such
       as &quot;http://example.net/index.html&quot;).  Improperly formatted
       solicitation class keywords, particularly those with a non-
       existent top level or second level domain, could result in a
       Denial of Service attack on DNS registry providers or the DNS
       root servers.

<span class="h2"><h2><a class="selflink" name="section-7" href="https://tools.ietf.org/html/rfc4095#section-7">7</a>. IANA Considerations</h2></span>

   There is no central registry maintained by the IANA of values that
   might appear in the &quot;SERVICE&quot; field of a NAPTR resource record.
   Thus, no direct IANA actions are required.

   However, the IANA does maintain an Application Service Tag Registry,
   which is used to support the S-NAPTR DDDS application defined in
   [<a href="https://tools.ietf.org/html/rfc3958" title="&quot;Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)&quot;">RFC3958</a>].  The IANA is advised that the &quot;no-solicit&quot; value for the
   SERVICE field is in use per this document and thus should not be used
   in the Application Service Tag Registry for other applications.

<span class="h2"><h2><a class="selflink" name="section-8" href="https://tools.ietf.org/html/rfc4095#section-8">8</a>. References</h2></span>

<span class="h3"><h3><a class="selflink" name="section-8.1" href="https://tools.ietf.org/html/rfc4095#section-8.1">8.1</a>. Normative References</h3></span>

   [<a name="ref-HTML-4.01" id="ref-HTML-4.01">HTML-4.01</a>] Raggett, D., Hors, A., and I. Jacobs, &quot;HTML 4.01
               Specification&quot;, W3C REC REC-html401-19991224,
               December 1999.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]   Bradner, S., &quot;Key words for use in RFCs to Indicate
               Requirement Levels&quot;, <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2660" id="ref-RFC2660">RFC2660</a>]   Rescorla, E. and A. Schiffman, &quot;The Secure HyperText
               Transfer Protocol&quot;, <a href="https://tools.ietf.org/html/rfc2660">RFC 2660</a>, August 1999.

   [<a name="ref-RFC3402" id="ref-RFC3402">RFC3402</a>]   Mealling, M., &quot;Dynamic Delegation Discovery System (DDDS)
               Part Two: The Algorithm&quot;, <a href="https://tools.ietf.org/html/rfc3402">RFC 3402</a>, October 2002.

   [<a name="ref-RFC3403" id="ref-RFC3403">RFC3403</a>]   Mealling, M., &quot;Dynamic Delegation Discovery System (DDDS)
               Part Three: The Domain Name System (DNS) Database&quot;,
               <a href="https://tools.ietf.org/html/rfc3403">RFC 3403</a>, October 2002.



<span class="grey">Malamud                     Standards Track                     [Page 9]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-10" id="page-10" href="https://tools.ietf.org/html/rfc4095#page-10" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


   [<a name="ref-RFC3865" id="ref-RFC3865">RFC3865</a>]   Malamud, C., &quot;A No Soliciting Simple Mail Transfer
               Protocol (SMTP) Service Extension&quot;, <a href="https://tools.ietf.org/html/rfc3865">RFC 3865</a>,
               September 2004.

   [<a name="ref-RFC3958" id="ref-RFC3958">RFC3958</a>]   Daigle, L. and A. Newton, &quot;Domain-Based Application
               Service Location Using SRV RRs and the Dynamic Delegation
               Discovery Service (DDDS)&quot;, <a href="https://tools.ietf.org/html/rfc3958">RFC 3958</a>, January 2005.

   [<a name="ref-RFC3986" id="ref-RFC3986">RFC3986</a>]   Berners-Lee, T., Fielding, R., and L. Masinter, &quot;Uniform
               Resource Identifier (URI): Generic Syntax&quot;, STD 66, <a href="https://tools.ietf.org/html/rfc3986">RFC</a>
               <a href="https://tools.ietf.org/html/rfc3986">3986</a>, January 2005.

<span class="h3"><h3><a class="selflink" name="section-8.2" href="https://tools.ietf.org/html/rfc4095#section-8.2">8.2</a>. Informative References</h3></span>

   [<a name="ref-RFC2795" id="ref-RFC2795">RFC2795</a>]   Christey, S., &quot;The Infinite Monkey Protocol Suite
              (IMPS)&quot;, <a href="https://tools.ietf.org/html/rfc2795">RFC 2795</a>, 1 April 2000.

   [<a name="ref-RFC2821" id="ref-RFC2821">RFC2821</a>]   Klensin, J., &quot;Simple Mail Transfer Protocol&quot;, <a href="https://tools.ietf.org/html/rfc2821">RFC 2821</a>,
              April 2001.

   [<a name="ref-RFC3401" id="ref-RFC3401">RFC3401</a>]   Mealling, M., &quot;Dynamic Delegation Discovery System (DDDS)
              Part One: The Comprehensive DDDS&quot;, <a href="https://tools.ietf.org/html/rfc3401">RFC 3401</a>, October 2002.

   [<a name="ref-RFC3490" id="ref-RFC3490">RFC3490</a>]   Faltstrom, P., Hoffman, P., and A. Costello,
              &quot;Internationalizing Domain Names in Applications (IDNA)&quot;,
              <a href="https://tools.ietf.org/html/rfc3490">RFC 3490</a>, March 2003.

   [<a name="ref-RFC3761" id="ref-RFC3761">RFC3761</a>]   Faltstrom, P. and M. Mealling, &quot;The E.164 to Uniform
              Resource Identifiers (URI) Dynamic Delegation Discovery
              System (DDDS) Application (ENUM)&quot;, <a href="https://tools.ietf.org/html/rfc3761">RFC 3761</a>, April 2004.

   [<a name="ref-RFC4033" id="ref-RFC4033">RFC4033</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, &quot;DNS Security Introduction and Requirements&quot;,
              <a href="https://tools.ietf.org/html/rfc4033">RFC 4033</a>, March 2005.

Author's Address

   Carl Malamud
   Memory Palace Press
   PO Box 300
   Sixes, OR  97476
   US

   EMail: carl@media.org







<span class="grey">Malamud                     Standards Track                    [Page 10]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-11" id="page-11" href="https://tools.ietf.org/html/rfc4095#page-11" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4095">RFC 4095</a>                  No-Solicit Discovery                  May 2005</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   &quot;AS IS&quot; basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Malamud                     Standards Track                    [Page 11]

</pre>
   <br /> 
   <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a> </small></small></span> 
  </div> 
 </body>
</html>