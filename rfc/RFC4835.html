<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head profile="http://dublincore.org/documents/2008/08/04/dc-html/"> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta name="robots" content="index,follow" /> 
  <meta name="creator" content="rfcmarkup version 1.127" /> 
  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" /> 
  <meta name="DC.Relation.Replaces" content="rfc4305" /> 
  <meta name="DC.Identifier" content="urn:ietf:rfc:4835" /> 
  <meta name="DC.Date.Issued" content="April, 2007" /> 
  <meta name="DC.Creator" content="Vishwas Manral &lt;vishwas@ipinfusion.com&gt;" /> 
  <meta name="DC.Description.Abstract" content="The IPsec series of protocols makes use of various cryptographic
algorithms in order to provide security services. The Encapsulating
Security Payload (ESP) and the Authentication Header (AH) provide two
mechanisms for protecting data being sent over an IPsec Security
Association (SA). To ensure interoperability between disparate
implementations, it is necessary to specify a set of mandatory-to-
implement algorithms to ensure that there is at least one algorithm
that all implementations will have available. This document defines
the current set of mandatory-to-implement algorithms for ESP and AH as
well as specifying algorithms that should be implemented because they
may be promoted to mandatory at some future time. [STANDARDS-TRACK]" /> 
  <meta name="DC.Title" content="Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)" /> 
  <link rel="icon" href="/images/rfc.png" type="image/png" /> 
  <link rel="shortcut icon" href="/images/rfc.png" type="image/png" /> 
  <title>RFC 4835 - Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</title> 
  <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style> 
  <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> 
  <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script> 
 </head> 
 <body onload="addHeaderTags()"> 
  <div class="content"> 
   <div style="height: 13px;"> 
    <div onmouseover="this.style.cursor='pointer';" onclick="showElem('legend');" onmouseout="hideElem('legend')" style="height: 6px; position: absolute;" class="pre noprint docinfo bgbrown" title="Click for colour legend."> 
    </div> 
    <div id="legend" class="docinfo noprint pre legend" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; " onmouseover="showElem('legend');" onmouseout="hideElem('legend');"> 
    </div> 
   </div> 
   <span class="pre noprint docinfo top">[<a href="https://tools.ietf.org/html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4835.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4835" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-manral-ipsec-rfc4305-bis-errata" title="draft-manral-ipsec-rfc4305-bis-errata">draft-manral-ip...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4835" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4835" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4835" title="Side-by-side diff">Diff2</a>] </span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <span class="pre noprint docinfo">Obsoleted by: <a href="https://tools.ietf.org/html/rfc7321">7321</a> PROPOSED STANDARD</span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <pre>Network Working Group                                          V. Manral
Request for Comments: 4835                              IP Infusion Inc.
Obsoletes: <a href="https://tools.ietf.org/html/rfc4305">4305</a>                                               April 2007
Category: Standards Track


        <span class="h1"><h1>Cryptographic Algorithm Implementation Requirements for</h1></span>
  <span class="h1"><h1>Encapsulating Security Payload (ESP) and Authentication Header (AH)</h1></span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   The IPsec series of protocols makes use of various cryptographic
   algorithms in order to provide security services.  The Encapsulating
   Security Payload (ESP) and the Authentication Header (AH) provide two
   mechanisms for protecting data being sent over an IPsec Security
   Association (SA).  To ensure interoperability between disparate
   implementations, it is necessary to specify a set of mandatory-to-
   implement algorithms to ensure that there is at least one algorithm
   that all implementations will have available.  This document defines
   the current set of mandatory-to-implement algorithms for ESP and AH
   as well as specifying algorithms that should be implemented because
   they may be promoted to mandatory at some future time.

















<span class="grey">Manral                       Standards Track                    [Page 1]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-2" id="page-2" href="https://tools.ietf.org/html/rfc4835#page-2" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


Table of Contents

   <a href="https://tools.ietf.org/html/rfc4835#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-3">3</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-2">2</a>.  Requirements Terminology  . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-3">3</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-3">3</a>.  Algorithm Selection . . . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-4">4</a>
     <a href="https://tools.ietf.org/html/rfc4835#section-3.1">3.1</a>.  Encapsulating Security Payload  . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-4">4</a>
       <a href="https://tools.ietf.org/html/rfc4835#section-3.1.1">3.1.1</a>.  ESP Encryption and Authentication Algorithms  . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-4">4</a>
       <a href="https://tools.ietf.org/html/rfc4835#section-3.1.2">3.1.2</a>.  ESP Combined Mode Algorithms  . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-5">5</a>
     <a href="https://tools.ietf.org/html/rfc4835#section-3.2">3.2</a>.  Authentication Header . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-5">5</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-4">4</a>.  Security Considerations . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-6">6</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-5">5</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-6">6</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-6">6</a>.  Changes from <a href="https://tools.ietf.org/html/rfc2402">RFC 2402</a> and <a href="https://tools.ietf.org/html/rfc2406">RFC 2406</a> to <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a>  . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-7">7</a>.  Changes from <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a> . . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc4835#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-8">8</a>
     <a href="https://tools.ietf.org/html/rfc4835#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-8">8</a>
     <a href="https://tools.ietf.org/html/rfc4835#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . . . <a href="https://tools.ietf.org/html/rfc4835#page-9">9</a>



































<span class="grey">Manral                       Standards Track                    [Page 2]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-3" id="page-3" href="https://tools.ietf.org/html/rfc4835#page-3" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


<span class="h2"><h2><a class="selflink" name="section-1" href="https://tools.ietf.org/html/rfc4835#section-1">1</a>. Introduction</h2></span>

   The Encapsulating Security Payload (ESP) and the Authentication
   Header (AH) provide two mechanisms for protecting data being sent
   over an IPsec Security Association (SA) [<a href="https://tools.ietf.org/html/rfc4301" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>], [<a href="https://tools.ietf.org/html/rfc4302" title="&quot;IP Authentication Header&quot;">RFC4302</a>].  To
   ensure interoperability between disparate implementations, it is
   necessary to specify a set of mandatory-to-implement algorithms to
   ensure that there is at least one algorithm that all implementations
   will have available.  This document defines the current set of
   mandatory-to-implement algorithms for ESP and AH as well as
   specifying algorithms that should be implemented because they may be
   promoted to mandatory at some future time.

   The nature of cryptography is that new algorithms surface
   continuously and existing algorithms are continuously attacked.  An
   algorithm believed to be strong today may be demonstrated to be weak
   tomorrow.  Given this, the choice of mandatory-to-implement algorithm
   should be conservative so as to minimize the likelihood of it being
   compromised quickly.  Thought should also be given to performance
   considerations as many uses of IPsec will be in environments where
   performance is a concern.

   Finally, we need to recognize that the mandatory-to-implement
   algorithm(s) may need to change over time to adapt to the changing
   world.  For this reason, the selection of mandatory-to-implement
   algorithms is not included in the main IPsec, ESP, or AH
   specifications.  It is instead placed in this document.  As the
   choice of algorithm changes, only this document should need to be
   updated.

   Ideally, the mandatory-to-implement algorithm of tomorrow should
   already be available in most implementations of IPsec by the time it
   is made mandatory.  To facilitate this, we will attempt to identify
   such algorithms (as they are known today) in this document.  There is
   no guarantee that the algorithms that we (today) believe may be
   mandatory in the future will in fact become so.  All algorithms known
   today are subject to cryptographic attack and may be broken in the
   future.

<span class="h2"><h2><a class="selflink" name="section-2" href="https://tools.ietf.org/html/rfc4835#section-2">2</a>. Requirements Terminology</h2></span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="https://tools.ietf.org/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].







<span class="grey">Manral                       Standards Track                    [Page 3]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-4" id="page-4" href="https://tools.ietf.org/html/rfc4835#page-4" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


   We define some additional terms here:

         SHOULD+  This term means the same as SHOULD.  However, it is
                  likely that an algorithm marked as SHOULD+ will be
                  promoted at some future time to be a MUST.

         SHOULD-  This term means the same as SHOULD.  However, it is
                  likely that an algorithm marked as SHOULD- will be
                  deprecated to a MAY or worse in a future version of
                  this document.

         MUST-    This term means the same as MUST.  However, we
                  expect that at some point in the future this algorithm
                  will no longer be a MUST.


<span class="h2"><h2><a class="selflink" name="section-3" href="https://tools.ietf.org/html/rfc4835#section-3">3</a>. Algorithm Selection</h2></span>

   For IPsec implementations to interoperate, they must support one or
   more security algorithms in common.  This section specifies the
   security algorithm implementation requirements for standards-
   conformant ESP and AH implementations.  The security algorithms
   actually used for any particular ESP or AH security association are
   determined by a negotiation mechanism, such as the Internet Key
   Exchange (IKE [<a href="https://tools.ietf.org/html/rfc2409" title="&quot;The Internet Key Exchange (IKE)&quot;">RFC2409</a>], [<a href="https://tools.ietf.org/html/rfc4306" title="&quot;Internet Key Exchange (IKEv2) Protocol&quot;">RFC4306</a>]) or pre-establishment.

   Of course, additional standard and proprietary algorithms beyond
   those listed below can be implemented.

<span class="h3"><h3><a class="selflink" name="section-3.1" href="https://tools.ietf.org/html/rfc4835#section-3.1">3.1</a>. Encapsulating Security Payload</h3></span>

   The implementation conformance requirements for security algorithms
   for ESP are given in the tables below.  See <a href="https://tools.ietf.org/html/rfc4835#section-2">Section 2</a> for definitions
   of the values in the &quot;Requirement&quot; column.

<span class="h4"><h4><a class="selflink" name="section-3.1.1" href="https://tools.ietf.org/html/rfc4835#section-3.1.1">3.1.1</a>. ESP Encryption and Authentication Algorithms</h4></span>

   These tables list encryption and authentication algorithms for the
   IPsec Encapsulating Security Payload protocol.

        Requirement    Encryption Algorithm (notes)
        -----------    --------------------------
        MUST           NULL [<a href="https://tools.ietf.org/html/rfc2410" title="&quot;The NULL Encryption Algorithm and Its Use With IPsec&quot;">RFC2410</a>] (1)
        MUST           AES-CBC with 128-bit keys [<a href="https://tools.ietf.org/html/rfc3602" title="&quot;The AES-CBC Cipher Algorithm and Its Use with IPsec&quot;">RFC3602</a>]
        MUST-          TripleDES-CBC [<a href="https://tools.ietf.org/html/rfc2451" title="&quot;The ESP CBC-Mode Cipher Algorithms&quot;">RFC2451</a>]
        SHOULD         AES-CTR [<a href="https://tools.ietf.org/html/rfc3686" title="&quot;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)&quot;">RFC3686</a>]
        SHOULD NOT     DES-CBC [<a href="https://tools.ietf.org/html/rfc2405" title="&quot;The ESP DES-CBC Cipher Algorithm With Explicit IV&quot;">RFC2405</a>] (2)




<span class="grey">Manral                       Standards Track                    [Page 4]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-5" id="page-5" href="https://tools.ietf.org/html/rfc4835#page-5" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


        Requirement    Authentication Algorithm (notes)
        -----------    -----------------------------
        MUST           HMAC-SHA1-96 [<a href="https://tools.ietf.org/html/rfc2404" title="&quot;The Use of HMAC-SHA-1-96 within ESP and AH&quot;">RFC2404</a>] (3)
        SHOULD+        AES-XCBC-MAC-96 [<a href="https://tools.ietf.org/html/rfc3566" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">RFC3566</a>]
        MAY            NULL (1)
        MAY            HMAC-MD5-96 [<a href="https://tools.ietf.org/html/rfc2403" title="&quot;The Use of HMAC-MD5-96 within ESP and AH&quot;">RFC2403</a>] (4)

   Notes:

      (1) Since ESP encryption is optional, support for the &quot;NULL&quot;
      algorithm is required to maintain consistency with the way
      services are negotiated.  Note that while authentication and
      encryption can each be &quot;NULL&quot;, they MUST NOT both be &quot;NULL&quot;
      [<a href="https://tools.ietf.org/html/rfc4301" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].

      (2) DES, with its small key size and publicly demonstrated and
      open-design special-purpose cracking hardware, is of questionable
      security for general use.

      (3) Weaknesses have become apparent in SHA-1 [<a href="https://tools.ietf.org/html/rfc4835#ref-SHA1-COLL" title="&quot;Update on SHA-1&quot;">SHA1-COLL</a>]; however,
      these should not affect the use of SHA1 with HMAC.

      (4) Weaknesses have become apparent in MD5 [<a href="https://tools.ietf.org/html/rfc4835#ref-MD5-COLL" title="&quot;Finding MD5 Collisions - a Toy For a Notebook&quot;">MD5-COLL</a>]; however,
      these should not affect the use of MD5 with HMAC.

<span class="h4"><h4><a class="selflink" name="section-3.1.2" href="https://tools.ietf.org/html/rfc4835#section-3.1.2">3.1.2</a>. ESP Combined Mode Algorithms</h4></span>

   As specified in [<a href="https://tools.ietf.org/html/rfc4303" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>], combined mode algorithms are supported
   that provide both confidentiality and authentication services.
   Support of such algorithms will require proper structuring of ESP
   implementations.  Under many circumstances, combined mode algorithms
   provide significant efficiency and throughput advantages.  Although
   there are no suggested or required combined algorithms at this time,
   AES-CCM [<a href="https://tools.ietf.org/html/rfc4309" title="&quot;Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)&quot;">RFC4309</a>] and AES-GCM [<a href="https://tools.ietf.org/html/rfc4106" title="&quot;The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)&quot;">RFC4106</a>] are of interest.  AES-CCM has
   been adopted as the preferred mode in IEEE 802.11 [<a href="https://tools.ietf.org/html/rfc4835#ref-802.11i" title="&quot;LAN/MAN Specific Requirements Part 11: Wireless Medium Access Control (MAC) and physical layer (PHY) specifications&quot;">802.11i</a>], and AES-
   GCM has been adopted as the preferred mode in IEEE 802.1ae [<a href="https://tools.ietf.org/html/rfc4835#ref-802.1ae" title="&quot;Media Access Control (MAC) Security&quot;">802.1ae</a>].

<span class="h3"><h3><a class="selflink" name="section-3.2" href="https://tools.ietf.org/html/rfc4835#section-3.2">3.2</a>. Authentication Header</h3></span>

   The implementation conformance requirements for security algorithms
   for AH are given below.  See <a href="https://tools.ietf.org/html/rfc4835#section-2">Section 2</a> for definitions of the values
   in the &quot;Requirement&quot; column.  As you would suspect, all of these
   algorithms are authentication algorithms.








<span class="grey">Manral                       Standards Track                    [Page 5]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-6" id="page-6" href="https://tools.ietf.org/html/rfc4835#page-6" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


       Requirement    Algorithm (notes)
       -----------    ----------------
       MUST           HMAC-SHA1-96 [<a href="https://tools.ietf.org/html/rfc2404" title="&quot;The Use of HMAC-SHA-1-96 within ESP and AH&quot;">RFC2404</a>] (1)
       SHOULD+        AES-XCBC-MAC-96 [<a href="https://tools.ietf.org/html/rfc3566" title="&quot;The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec&quot;">RFC3566</a>]
       MAY            HMAC-MD5-96 [<a href="https://tools.ietf.org/html/rfc2403" title="&quot;The Use of HMAC-MD5-96 within ESP and AH&quot;">RFC2403</a>] (2)

   Note:

      (1) Weaknesses have become apparent in SHA-1 [<a href="https://tools.ietf.org/html/rfc4835#ref-SHA1-COLL" title="&quot;Update on SHA-1&quot;">SHA1-COLL</a>]; however,
      these should not affect the use of SHA1 with HMAC.

      (2) Weaknesses have become apparent in MD5 [<a href="https://tools.ietf.org/html/rfc4835#ref-MD5-COLL" title="&quot;Finding MD5 Collisions - a Toy For a Notebook&quot;">MD5-COLL</a>]; however,
      these should not affect the use of MD5 with HMAC.

<span class="h2"><h2><a class="selflink" name="section-4" href="https://tools.ietf.org/html/rfc4835#section-4">4</a>. Security Considerations</h2></span>

   The security of cryptography-based systems depends on both the
   strength of the cryptographic algorithms chosen and the strength of
   the keys used with those algorithms.  The security also depends on
   the engineering and administration of the protocol used by the system
   to ensure that there are no non-cryptographic ways to bypass the
   security of the overall system.

   This document concerns itself with the selection of cryptographic
   algorithms for the use of ESP and AH, specifically with the selection
   of mandatory-to-implement algorithms.  The algorithms identified in
   this document as &quot;MUST implement&quot; or &quot;SHOULD implement&quot; are not known
   to be broken at the current time, and cryptographic research so far
   leads us to believe that they will likely remain secure into the
   foreseeable future.  However, this is not necessarily forever.  We
   would therefore expect that new revisions of this document will be
   issued from time to time that reflect the current best practice in
   this area.

<span class="h2"><h2><a class="selflink" name="section-5" href="https://tools.ietf.org/html/rfc4835#section-5">5</a>. Acknowledgements</h2></span>

   Much of the wording herein was adapted from <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a>, the parent
   document of this document.  <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a> itself borrows text from
   [<a href="https://tools.ietf.org/html/rfc4307" title="&quot;Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)&quot;">RFC4307</a>], &quot;Cryptographic Algorithms for Use in the Internet Key
   Exchange Version 2&quot;, by Jeffrey I. Schiller.

   Thanks to the following people for reporting or responding to reports
   of the errors in <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a>: Paul Hoffman, Stephen Kent, Paul Koning,
   and Lars Volker.  Helpful Last-Call comments were received from Russ
   Housley, Elwyn Davies, Nicolas Williams, and Alfred Hoenes.






<span class="grey">Manral                       Standards Track                    [Page 6]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-7" id="page-7" href="https://tools.ietf.org/html/rfc4835#page-7" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


<span class="h2"><h2><a class="selflink" name="section-6" href="https://tools.ietf.org/html/rfc4835#section-6">6</a>. Changes from <a href="https://tools.ietf.org/html/rfc2402">RFC 2402</a> and <a href="https://tools.ietf.org/html/rfc2406">RFC 2406</a> to <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a></h2></span>

   [<a name="ref-RFC2402" id="ref-RFC2402">RFC2402</a>] and [<a href="https://tools.ietf.org/html/rfc2406" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC2406</a>] defined the IPsec Authentication Header and
   IPsec Encapsulating Security Payload.  Each specified the
   implementation requirements for cryptographic algorithms for their
   respective protocols.  They have now been replaced with [<a href="https://tools.ietf.org/html/rfc4302" title="&quot;IP Authentication Header&quot;">RFC4302</a>] and
   [<a href="https://tools.ietf.org/html/rfc4303" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>], which do not specify cryptographic algorithm
   implementation requirements, and this document, which specifies such
   requirements for both [<a href="https://tools.ietf.org/html/rfc4302" title="&quot;IP Authentication Header&quot;">RFC4302</a>] and [<a href="https://tools.ietf.org/html/rfc4303" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>].

   The implementation requirements are compared below:

      Old    Old             New
      Req.   RFC(s)       Requirement     Algorithm (notes)
      ----   ------       -----------     -----------------
      MUST   2406         SHOULD NOT      DES-CBC [<a href="https://tools.ietf.org/html/rfc2405" title="&quot;The ESP DES-CBC Cipher Algorithm With Explicit IV&quot;">RFC2405</a>] (1)
      MUST   2402 2406    MAY             HMAC-MD5-96 [<a href="https://tools.ietf.org/html/rfc2403" title="&quot;The Use of HMAC-MD5-96 within ESP and AH&quot;">RFC2403</a>]
      MUST   2402 2406    MUST            HMAC-SHA1-96 [<a href="https://tools.ietf.org/html/rfc2404" title="&quot;The Use of HMAC-SHA-1-96 within ESP and AH&quot;">RFC2404</a>]


   Note:

      (1) The IETF deprecated the use of single DES years ago and has
      not included it in any new standard for some time (see IESG note
      on the first page of [<a href="https://tools.ietf.org/html/rfc2407" title="&quot;The Internet IP Security Domain of Interpretation for ISAKMP&quot;">RFC2407</a>]).  [<a href="https://tools.ietf.org/html/rfc4305" title="&quot;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)&quot;">RFC4305</a>] represented the first
      standards-track recognition of that deprecation by specifying that
      implementations SHOULD NOT provide single DES.  The US Government
      National Institute of Standards and Technology (NIST) has formally
      recognized the weakness of single DES by a notice published
      [<a href="https://tools.ietf.org/html/rfc4835#ref-DES-WDRAW" title="&quot;Announcing Proposed Withdrawal of Federal Information Processing Standard (FIPS) for the Data Encryption Standard (DES) and Request for Comments&quot;">DES-WDRAW</a>] proposing to withdraw it as a US Government Standard.
      Triple DES remains approved by both the IETF and NIST.

<span class="h2"><h2><a class="selflink" name="section-7" href="https://tools.ietf.org/html/rfc4835#section-7">7</a>. Changes from <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a></h2></span>

   This document obsoletes [<a href="https://tools.ietf.org/html/rfc4305" title="&quot;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)&quot;">RFC4305</a>].  The document incorporates changes
   for the support for the NULL Authentication Algorithm making the
   support from a MUST to a MAY.  This change is made to make this
   document consistent with [<a href="https://tools.ietf.org/html/rfc4301" title="&quot;Security Architecture for the Internet Protocol&quot;">RFC4301</a>].  Text for SHA-1 collision attacks
   as well as the future use of AES-GCM and AES-CCM is added.












<span class="grey">Manral                       Standards Track                    [Page 7]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-8" id="page-8" href="https://tools.ietf.org/html/rfc4835#page-8" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


   The changed implementation requirement resulting from the above
   changes is listed below:

      Old      Old         New
      Req.     RFC(s)      Requirement  Algorithm (notes)
      ----     ------      -----------  -----------------
      MUST     2406        MAY          NULL Authentication
      MUST     2406        MUST         NULL Encryption
      SHOULD+  4305        MUST         AES-CBC Encryption

<span class="h2"><h2><a class="selflink" name="section-8" href="https://tools.ietf.org/html/rfc4835#section-8">8</a>. References</h2></span>

<span class="h3"><h3><a class="selflink" name="section-8.1" href="https://tools.ietf.org/html/rfc4835#section-8.1">8.1</a>. Normative References</h3></span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]    Bradner, S., &quot;Key words for use in RFCs to Indicate
                Requirement Levels&quot;, <a href="https://tools.ietf.org/html/bcp14">BCP14</a>,  <a href="https://tools.ietf.org/html/rfc2119">RFC2119</a>, March 1997.

   [<a name="ref-RFC2403" id="ref-RFC2403">RFC2403</a>]    Madson, C. and R. Glenn, &quot;The Use of HMAC-MD5-96 within
                ESP and AH&quot;, <a href="https://tools.ietf.org/html/rfc2403">RFC 2403</a>, November 1998.

   [<a name="ref-RFC2404" id="ref-RFC2404">RFC2404</a>]    Madson, C. and R. Glenn, &quot;The Use of HMAC-SHA-1-96
                within ESP and AH&quot;, <a href="https://tools.ietf.org/html/rfc2404">RFC 2404</a>, November 1998.

   [<a name="ref-RFC2405" id="ref-RFC2405">RFC2405</a>]    Madson, C. and N. Doraswamy, &quot;The ESP DES-CBC Cipher
                Algorithm With Explicit IV&quot;, <a href="https://tools.ietf.org/html/rfc2405">RFC 2405</a>, November 1998.

   [<a name="ref-RFC2410" id="ref-RFC2410">RFC2410</a>]    Glenn, R. and S. Kent, &quot;The NULL Encryption Algorithm
                and Its Use With IPsec&quot;, <a href="https://tools.ietf.org/html/rfc2410">RFC 2410</a>, November 1998.

   [<a name="ref-RFC2451" id="ref-RFC2451">RFC2451</a>]    Pereira, R. and R. Adams, &quot;The ESP CBC-Mode Cipher
                Algorithms&quot;, <a href="https://tools.ietf.org/html/rfc2451">RFC 2451</a>, November 1998.

   [<a name="ref-RFC3566" id="ref-RFC3566">RFC3566</a>]    Frankel, S. and H. Herbert, &quot;The AES-XCBC-MAC-96
                Algorithm and Its Use With IPsec&quot;, <a href="https://tools.ietf.org/html/rfc3566">RFC 3566</a>,
                September 2003.

   [<a name="ref-RFC3602" id="ref-RFC3602">RFC3602</a>]    Frankel, S., Glenn, R., and S. Kelly, &quot;The AES-CBC
                Cipher Algorithm and Its Use with IPsec&quot;, <a href="https://tools.ietf.org/html/rfc3602">RFC 3602</a>,
                September 2003.

   [<a name="ref-RFC3686" id="ref-RFC3686">RFC3686</a>]    Housley, R., &quot;Using Advanced Encryption Standard (AES)
                Counter Mode With IPsec Encapsulating Security Payload
                (ESP)&quot;, <a href="https://tools.ietf.org/html/rfc3686">RFC 3686</a>, January 2004.

   [<a name="ref-RFC4301" id="ref-RFC4301">RFC4301</a>]    Kent, S. and K. Seo, &quot;Security Architecture for the
                Internet Protocol&quot;, <a href="https://tools.ietf.org/html/rfc4301">RFC 4301</a>, December 2005.

   [<a name="ref-RFC4302" id="ref-RFC4302">RFC4302</a>]    Kent, S., &quot;IP Authentication Header&quot;, <a href="https://tools.ietf.org/html/rfc4302">RFC 4302</a>,



<span class="grey">Manral                       Standards Track                    [Page 8]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-9" id="page-9" href="https://tools.ietf.org/html/rfc4835#page-9" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


                December 2005.

   [<a name="ref-RFC4303" id="ref-RFC4303">RFC4303</a>]    Kent, S., &quot;IP Encapsulating Security Payload (ESP)&quot;,
                <a href="https://tools.ietf.org/html/rfc4303">RFC 4303</a>, December 2005.

   [<a name="ref-RFC4305" id="ref-RFC4305">RFC4305</a>]    Eastlake, D., &quot;Cryptographic Algorithm Implementation
                Requirements for Encapsulating Security Payload (ESP)
                and Authentication Header (AH)&quot;, <a href="https://tools.ietf.org/html/rfc4305">RFC 4305</a>,
                December 2005.

<span class="h3"><h3><a class="selflink" name="section-8.2" href="https://tools.ietf.org/html/rfc4835#section-8.2">8.2</a>. Informative References</h3></span>

   [<a name="ref-802.11i" id="ref-802.11i">802.11i</a>]    &quot;LAN/MAN Specific Requirements Part 11: Wireless Medium
                Access Control (MAC) and physical layer (PHY)
                specifications&quot;, IEEE Standard Medium Access Control
                (MAC) Security, IEEE Std 802.11i, June 2004.

   [<a name="ref-802.1ae" id="ref-802.1ae">802.1ae</a>]    &quot;Media Access Control (MAC) Security&quot;, IEEE
                Standard Medium Access Control (MAC) Security, IEEE Std
                802.1ae, June 2006.

   [<a name="ref-DES-WDRAW" id="ref-DES-WDRAW">DES-WDRAW</a>]  &quot;Announcing Proposed Withdrawal of Federal Information
                Processing Standard (FIPS) for the Data Encryption
                Standard (DES) and Request for Comments&quot;, FIPS
                Notice Docket No. 040602169-4169-01, July 2004.

   [<a name="ref-MD5-COLL" id="ref-MD5-COLL">MD5-COLL</a>]   Klima, V., &quot;Finding MD5 Collisions - a Toy For a
                Notebook&quot;, Cryptology ePrint Archive Medium Report 2005/
                075, March 2005.

   [<a name="ref-RFC2402" id="ref-RFC2402">RFC2402</a>]    Kent, S. and R. Atkinson, &quot;IP Authentication Header&quot;,
                <a href="https://tools.ietf.org/html/rfc2402">RFC 2402</a>, November 1998.

   [<a name="ref-RFC2406" id="ref-RFC2406">RFC2406</a>]    Kent, S. and R. Atkinson, &quot;IP Encapsulating Security
                Payload (ESP)&quot;, <a href="https://tools.ietf.org/html/rfc2406">RFC 2406</a>, November 1998.

   [<a name="ref-RFC2407" id="ref-RFC2407">RFC2407</a>]    Piper, D., &quot;The Internet IP Security Domain of
                Interpretation for ISAKMP&quot;, <a href="https://tools.ietf.org/html/rfc2407">RFC 2407</a>, November 1998.

   [<a name="ref-RFC2409" id="ref-RFC2409">RFC2409</a>]    Harkins, D. and D. Carrel, &quot;The Internet Key Exchange
                (IKE)&quot;, <a href="https://tools.ietf.org/html/rfc2409">RFC 2409</a>, November 1998.

   [<a name="ref-RFC4106" id="ref-RFC4106">RFC4106</a>]    Viega, J. and D. McGrew, &quot;The Use of Galois/Counter Mode
                (GCM) in IPsec Encapsulating Security Payload (ESP)&quot;,
                <a href="https://tools.ietf.org/html/rfc4106">RFC 4106</a>, June 2005.

   [<a name="ref-RFC4306" id="ref-RFC4306">RFC4306</a>]    Kaufman, C., &quot;Internet Key Exchange (IKEv2) Protocol&quot;,
                <a href="https://tools.ietf.org/html/rfc4306">RFC 4306</a>, December 2005.



<span class="grey">Manral                       Standards Track                    [Page 9]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-10" id="page-10" href="https://tools.ietf.org/html/rfc4835#page-10" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


   [<a name="ref-RFC4307" id="ref-RFC4307">RFC4307</a>]    Schiller, J., &quot;Cryptographic Algorithms for Use in the
                Internet Key Exchange Version 2 (IKEv2)&quot;, <a href="https://tools.ietf.org/html/rfc4307">RFC 4307</a>,
                December 2005.

   [<a name="ref-RFC4309" id="ref-RFC4309">RFC4309</a>]    Housley, R., &quot;Using Advanced Encryption Standard (AES)
                CCM Mode with IPsec Encapsulating Security Payload
                (ESP)&quot;, <a href="https://tools.ietf.org/html/rfc4309">RFC 4309</a>, December 2005.

   [<a name="ref-SHA1-COLL" id="ref-SHA1-COLL">SHA1-COLL</a>]  Rijmen, V. and E. Oswald, &quot;Update on SHA-1&quot;, Cryptology
                ePrint Archive Report 2005/010, January 2005.

Author's Address

   Vishwas Manral
   IP Infusion Inc.
   Bamankhola, Bansgali,
   Almora, Uttarakhand  263601
   India

   Phone: +91-98456-61911
   EMail: vishwas@ipinfusion.com






























<span class="grey">Manral                       Standards Track                   [Page 10]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-11" id="page-11" href="https://tools.ietf.org/html/rfc4835#page-11" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc4835">RFC 4835</a>           Cryptographic Algorithms ESP and AH        April 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   &quot;AS IS&quot; basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Manral                       Standards Track                   [Page 11]

</pre>
   <br /> 
   <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a> </small></small></span> 
  </div> 
 </body>
</html>