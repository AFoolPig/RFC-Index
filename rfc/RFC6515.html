<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head profile="http://dublincore.org/documents/2008/08/04/dc-html/"> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta name="robots" content="index,follow" /> 
  <meta name="creator" content="rfcmarkup version 1.127" /> 
  <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" /> 
  <meta name="DC.Relation.Replaces" content="draft-rosen-l3vpn-mvpn-infra-addrs" /> 
  <meta name="DC.Identifier" content="urn:ietf:rfc:6515" /> 
  <meta name="DC.Date.Issued" content="February, 2012" /> 
  <meta name="DC.Creator" content="Rosen, Eric C." /> 
  <meta name="DC.Creator" content="Aggarwal, Rahul" /> 
  <meta name="DC.Description.Abstract" content="To provide Multicast VPN service, a provider edge router originates
Multicast-VPN (&quot;MCAST-VPN&quot;) BGP routes. These routes encode addresses
from the customer's address space as well as addresses from the
provider's address space. The customer's address space may be
either IPv4 or IPv6. Independently, the provider's address space
may be either IPv4 or IPv6. The MCAST-VPN BGP routes always contain an
&quot;address family&quot; field that specifies whether the customer addresses
are IPv4 addresses or whether they are IPv6 addresses. However, there
is no field that explicitly specifies whether the provider addresses
are IPv4 addresses or whether they are IPv6 addresses. To ensure
interoperability, this document specifies that MCAST-VPN routes always
encode provider IPv4 addresses as four-octet addresses, and that the
distinction between an IPv4 address and an IPv6 address is signaled
solely by the length of the address field." /> 
  <meta name="DC.Title" content="IPv4 and IPv6 Infrastructure Addresses in BGP Updates for Multicast VPN" /> 
  <link rel="icon" href="/images/rfc.png" type="image/png" /> 
  <link rel="shortcut icon" href="/images/rfc.png" type="image/png" /> 
  <title>RFC 6515 - IPv4 and IPv6 Infrastructure Addresses in BGP Updates for Multicast VPN</title> 
  <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style> 
  <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]--> 
  <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script> 
 </head> 
 <body onload="addHeaderTags()"> 
  <div class="content"> 
   <div style="height: 13px;"> 
    <div onmouseover="this.style.cursor='pointer';" onclick="showElem('legend');" onmouseout="hideElem('legend')" style="height: 6px; position: absolute;" class="pre noprint docinfo bgblue" title="Click for colour legend."> 
    </div> 
    <div id="legend" class="docinfo noprint pre legend" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; " onmouseover="showElem('legend');" onmouseout="hideElem('legend');"> 
    </div> 
   </div> 
   <span class="pre noprint docinfo top">[<a href="https://tools.ietf.org/html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6515.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6515" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-l3vpn-mvpn-infra-addrs" title="draft-ietf-l3vpn-mvpn-infra-addrs">draft-ietf-l3vp...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6515" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6515" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6515" title="Side-by-side diff">Diff2</a>] </span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <span class="pre noprint docinfo"> PROPOSED STANDARD</span>
   <br /> 
   <span class="pre noprint docinfo"> </span>
   <br /> 
   <pre>Internet Engineering Task Force (IETF)                       R. Aggarwal
Request for Comments: 6515                        Juniper Networks, Inc.
Updates: <a href="https://tools.ietf.org/html/rfc6514">6514</a>                                                   E. Rosen
Category: Standard Track                             Cisco Systems, Inc.
ISSN: 2070-1721                                            February 2012


               <span class="h1"><h1>IPv4 and IPv6 Infrastructure Addresses in</h1></span>
                     <span class="h1"><h1>BGP Updates for Multicast VPN</h1></span>

Abstract

   To provide Multicast VPN (MVPN) service, Provider Edge routers
   originate BGP Update messages that carry Multicast-VPN (&quot;MCAST-VPN&quot;)
   BGP routes; they also originate unicast VPN routes that carry MVPN-
   specific attributes.  These routes encode addresses from the
   customer's address space, as well as addresses from the provider's
   address space.  These two address spaces are independent, and the
   address family (IPv4 or IPv6) of the two spaces may or may not be the
   same.  These routes always contain an &quot;address family&quot; field that
   specifies whether the customer addresses are IPv4 addresses or
   whether they are IPv6 addresses.  However, there is no field that
   explicitly specifies the address family of the provider addresses.
   To ensure interoperability, this document specifies that provider
   IPv4 addresses are always encoded in these update messages as 4-octet
   addresses, and that the distinction between IPv4 and IPv6 is signaled
   solely by the length of the address field.  Specific cases are
   explained in detail.  This document updates <a href="https://tools.ietf.org/html/rfc6514">RFC 6514</a>.


Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="https://tools.ietf.org/html/rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6515">http://www.rfc-editor.org/info/rfc6515</a>.








<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 1]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-2" id="page-2" href="https://tools.ietf.org/html/rfc6515#page-2" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="https://tools.ietf.org/html/rfc6515#section-1">1</a>. Introduction ....................................................<a href="https://tools.ietf.org/html/rfc6515#page-2">2</a>
      <a href="https://tools.ietf.org/html/rfc6515#section-1.1">1.1</a>. IPv4 and IPv6 Addresses in MCAST-VPN Routes ................<a href="https://tools.ietf.org/html/rfc6515#page-2">2</a>
      <a href="https://tools.ietf.org/html/rfc6515#section-1.2">1.2</a>. Specification of Requirements ..............................<a href="https://tools.ietf.org/html/rfc6515#page-4">4</a>
      <a href="https://tools.ietf.org/html/rfc6515#section-1.3">1.3</a>. Acronyms Used in This Document .............................<a href="https://tools.ietf.org/html/rfc6515#page-4">4</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-2">2</a>. PE Addresses in MCAST-VPN Routes ................................<a href="https://tools.ietf.org/html/rfc6515#page-4">4</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-3">3</a>. VRF Route Import Extended Community .............................<a href="https://tools.ietf.org/html/rfc6515#page-5">5</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-4">4</a>. PMSI Tunnel Attributes in I-PMSI A-D Routes .....................<a href="https://tools.ietf.org/html/rfc6515#page-6">6</a>
      <a href="https://tools.ietf.org/html/rfc6515#section-4.1">4.1</a>. Relationship to AFI Value ..................................<a href="https://tools.ietf.org/html/rfc6515#page-6">6</a>
      <a href="https://tools.ietf.org/html/rfc6515#section-4.2">4.2</a>. Relationship to Next Hop Address Family ....................<a href="https://tools.ietf.org/html/rfc6515#page-6">6</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-5">5</a>. IANA Considerations .............................................<a href="https://tools.ietf.org/html/rfc6515#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-6">6</a>. Security Considerations .........................................<a href="https://tools.ietf.org/html/rfc6515#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-7">7</a>. Acknowledgments .................................................<a href="https://tools.ietf.org/html/rfc6515#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-8">8</a>. Normative References ............................................<a href="https://tools.ietf.org/html/rfc6515#page-7">7</a>
   <a href="https://tools.ietf.org/html/rfc6515#section-9">9</a>. Informative References ..........................................<a href="https://tools.ietf.org/html/rfc6515#page-7">7</a>

<span class="h2"><h2><a class="selflink" name="section-1" href="https://tools.ietf.org/html/rfc6515#section-1">1</a>. Introduction</h2></span>

<span class="h3"><h3><a class="selflink" name="section-1.1" href="https://tools.ietf.org/html/rfc6515#section-1.1">1.1</a>. IPv4 and IPv6 Addresses in MCAST-VPN Routes</h3></span>

   [<a name="ref-MVPN-BGP" id="ref-MVPN-BGP">MVPN-BGP</a>] defines a new set of BGP route types that are used by
   service providers (SPs) to provide Multicast Virtual Private Network
   service to their customers.  These routes have a newly defined BGP
   NLRI, the &quot;MCAST-VPN&quot; NLRI.  The MCAST-VPN NLRI is carried in the
   NLRI field of the MP_REACH_NLRI/MP_UNREACH_NLRI attributes defined in
   [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].  The SAFI field of the MP_REACH_NLRI/MP_UNREACH_NLRI
   attribute is used to identify the NLRI as being an MCAST-VPN NLRI.








<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 2]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-3" id="page-3" href="https://tools.ietf.org/html/rfc6515#page-3" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


   When the SAFI field of an MP_REACH_NLRI/MP_UNREACH_NLRI attribute has
   the &quot;MCAST-VPN&quot; value, the AFI field has two defined values: 1 and 2.
   AFI 1 indicates that any customer multicast addresses occurring in
   the MP_REACH_NLRI/MP_UNREACH_NLRI attribute are IPv4 addresses; AFI 2
   indicates that such addresses are IPv6 addresses.

   However, some of the MCAST-VPN routes also contain addresses of
   Provider Edge (PE) routers in the SP network.  An SP with an IPv4
   network may provide MVPN service for customers using IPv6, and an SP
   with an IPv6 network may provide MVPN service for customers that use
   IPv4.  Therefore, the address family of the PE addresses MUST NOT be
   inferred from the AFI field of the associated
   MP_REACH_NLRI/MP_UNREACH_NLRI attribute.

   The purpose of this document is to make clear that whenever a PE
   address occurs in an MCAST-VPN route (whether in the NLRI or in an
   attribute), the IP address family of that address is determined by
   the length of the address (a length of 4 octets for IPv4 addresses, a
   length of 16 octets for IPv6 addresses), NOT by the AFI field of the
   route.

   In particular, if a SP with an IPv4 core network is providing
   MVPN/IPv6 service to a customer, the PE addresses in the MCAST-VPN
   routes will be 4-octet IPv4 routes, even though the AFI of those
   routes will have the value 2.

   Some previous specifications (e.g., [<a href="https://tools.ietf.org/html/rfc4659" title="&quot;BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN&quot;">RFC4659</a>] and [<a href="https://tools.ietf.org/html/rfc4798" title="&quot;Connecting IPv6 Islands over IPv4 MPLS Using IPv6 Provider Edge Routers (6PE)&quot;">RFC4798</a>]) have
   taken a different approach, requiring that in any routes containing
   IPv6 or VPN-IPv6 customer addresses, the IPv4 PE addresses be
   represented as IPv6-mapped IPv4 addresses [<a href="https://tools.ietf.org/html/rfc4291" title="&quot;IP Version 6 Addressing Architecture&quot;">RFC4291</a>].  This document
   does not use that approach.  Rather, this specification uses the
   approach adopted in [<a href="https://tools.ietf.org/html/rfc4684" title="&quot;Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)&quot;">RFC4684</a>] and [<a href="https://tools.ietf.org/html/rfc5549" title="&quot;Advertising IPv4 Network Layer Reachability Information with an IPv6 Next Hop&quot;">RFC5549</a>].  The MCAST-VPN routes
   contain enough information to enable the IP address family of the PE
   addresses to be inferred from the address lengths.

   [<a name="ref-MVPN-BGP" id="ref-MVPN-BGP">MVPN-BGP</a>] also defines an attribute, the &quot;VRF Route Import Extended
   Community&quot;, that is attached to unicast VPN-IPv4 or VPN-IPv6 routes.
   This extended community contains a PE address, and this document
   specifies how to encode an IPv6 address in this attribute,
   independent of whether the attribute is attached to a VPN-IPv4 route
   or a VPN-IPv6 route.

   This document also clarifies an issue with respect to the
   significance of the Address Family field of an Intra-AS I-PMSI A-D
   route that carries a PMSI Tunnel Attribute.






<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 3]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-4" id="page-4" href="https://tools.ietf.org/html/rfc6515#page-4" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


<span class="h3"><h3><a class="selflink" name="section-1.2" href="https://tools.ietf.org/html/rfc6515#section-1.2">1.2</a>. Specification of Requirements</h3></span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="https://tools.ietf.org/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h3"><h3><a class="selflink" name="section-1.3" href="https://tools.ietf.org/html/rfc6515#section-1.3">1.3</a>. Acronyms Used in This Document</h3></span>

   This document uses a number of acronyms, mostly taken directly from
   the BGP and VPN specifications.

   - A-D Route: Auto-Discovery Route [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN" title="&quot;Multicast in MPLS/BGP IP VPNs&quot;">MVPN</a>]

   - AFI: Address Family Identifier [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>]

   - AS: Autonomous System [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP" title="&quot;A Border Gateway Protocol 4 (BGP-4)&quot;">BGP</a>]

   - I-PMSI: Inclusive PMSI [<a href="https://tools.ietf.org/html/rfc4364" title="&quot;BGP/MPLS IP Virtual Private Networks (VPNs)&quot;">RFC4364</a>]

   - MVPN: Multicast Virtual Private Network [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN" title="&quot;Multicast in MPLS/BGP IP VPNs&quot;">MVPN</a>]

   - MCAST-VPN routes: BGP routes of &quot;MCAST-VPN&quot; Subsequent Address
     Family, as defined in [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].  The NLRI of such routes may be
     referred to as MCAST-VPN NLRI.

   - MP_REACH_NLRI: Multiprotocol Reachable NLRI [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>]

   - MP_UNREACH_NLRI: Multiprotocol Unreachable NLRI [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>]

   - PMSI: Provider Multicast Service Interface [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN" title="&quot;Multicast in MPLS/BGP IP VPNs&quot;">MVPN</a>]

   - NLRI: Network Layer Reachability Information [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP" title="&quot;A Border Gateway Protocol 4 (BGP-4)&quot;">BGP</a>]

   - PE: Provider Edge [<a href="https://tools.ietf.org/html/rfc4364" title="&quot;BGP/MPLS IP Virtual Private Networks (VPNs)&quot;">RFC4364</a>]

   - S-PMSI: Selective PMSI [<a href="https://tools.ietf.org/html/rfc4364" title="&quot;BGP/MPLS IP Virtual Private Networks (VPNs)&quot;">RFC4364</a>]

   - SAFI: Subsequent Address Field Identifier [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>]

   - SP: Service Provider

<span class="h2"><h2><a class="selflink" name="section-2" href="https://tools.ietf.org/html/rfc6515#section-2">2</a>. PE Addresses in MCAST-VPN Routes</h2></span>

     PE addresses occur in MCAST-VPN routes in the following places:

   1. &quot;Network Address of Next Hop&quot; field in the MP_REACH_NLRI
      attribute, as defined in Section 3 of [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].  This field is
      preceded by a &quot;length of next hop address&quot; field.  Hence, it is



<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 4]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-5" id="page-5" href="https://tools.ietf.org/html/rfc6515#page-5" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


      always clear whether the address is an IPv4 address (length is 4)
      or an IPv6 address (length is 16).  If the length of the next hop
      address is neither 4 nor 16, the MP_REACH_NLRI attribute MUST be
      considered to be &quot;incorrect&quot;, and MUST be handled as specified in
      Section 7 of [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].

   2. &quot;Intra-AS I-PMSI A-D route&quot;, defined in Section 4.1 of [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].
      All MCAST-VPN routes begin with a 1-octet route type field,
      followed by a 1-octet &quot;NLRI length&quot; field.  In the Intra-AS I-PMSI
      A-D route, the length is followed by an 8-octet Route
      Distinguisher (RD), which is then followed by the &quot;Originating
      Router's IP Address&quot; field.  The length of this field (4 octets
      for IPv4 or 16 octets for IPv6) can thus be inferred from the NLRI
      length field (which will be either 12 or 24, respectively).  If
      the inferred length of the &quot;Originating Router's IP Address&quot; field
      is neither 4 nor 16, the MP_REACH_NLRI attribute MUST be
      considered to be &quot;incorrect&quot;, and MUST be handled as specified in
      Section 7 of [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].

   3. &quot;S-PMSI A-D Route&quot;, defined in Section 4.3 of [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].  In this
      route, the &quot;NLRI length&quot; field is followed by an 8-octet RD, a
      variable-length &quot;multicast source&quot; field, a variable-length
      &quot;multicast group&quot; field, and an &quot;Originating Router's IP Address&quot;
      field.  The two variable-length fields have their own length
      fields.  From these two length fields and the NLRI length field,
      one can compute the length of the &quot;Originating Router's IP
      Address&quot; field, which again is either 4 for IPv4 or 16 for IPv6.
      If the computed length of the &quot;Originating Router's IP Address&quot;
      field is neither 4 nor 16, the MP_REACH_NLRI attribute MUST be
      considered to be &quot;incorrect&quot;, and MUST be handled as specified in
      Section 7 of [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].

   4. &quot;Leaf A-D Route&quot;, defined in Section 4.4 of [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].  In this
      route, the &quot;NLRI length&quot; field is following by a variable-length
      &quot;route key&quot;, which is followed by the &quot;Originating Router's IP
      Address&quot; field.  The Route Key has its own length field.  From the
      NLRI length and the route key length, one can compute the length
      of the &quot;Originating Router's IP Address&quot; field.  If the computed
      length of the &quot;Originating Router's IP Address&quot; field is neither 4
      nor 16, the MP_REACH_NLRI attribute MUST be considered to be
      &quot;incorrect&quot;, and MUST be handled as specified in Section 7 of
      [<a href="https://tools.ietf.org/html/rfc6515#ref-BGP-MP" title="&quot;Multiprotocol Extensions for BGP-4&quot;">BGP-MP</a>].

<span class="h2"><h2><a class="selflink" name="section-3" href="https://tools.ietf.org/html/rfc6515#section-3">3</a>. VRF Route Import Extended Community</h2></span>

   The &quot;VRF Route Import Extended Community&quot;, specified in [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>],
   is an attribute carried by unicast VPN-IPv4 or VPN-IPv6 routes.  It
   is an &quot;IPv4 Address Specific Extended Community&quot; of type &quot;VRF Route



<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 5]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-6" id="page-6" href="https://tools.ietf.org/html/rfc6515#page-6" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


   Import&quot;; hence, it can only carry an IPv4 address.  To carry an IPv6
   address, an &quot;IPv6 Address Specific Extended Community&quot; [<a href="https://tools.ietf.org/html/rfc5701" title="&quot;IPv6 Address Specific BGP Extended Community Attribute&quot;">RFC5701</a>], of
   type &quot;VRF Route Import&quot;, must be used.  A code point for this type of
   extended community has been allocated by IANA.

<span class="h2"><h2><a class="selflink" name="section-4" href="https://tools.ietf.org/html/rfc6515#section-4">4</a>. PMSI Tunnel Attributes in I-PMSI A-D Routes</h2></span>

   When a PMSI Tunnel Attribute occurs in an I-PMSI A-D route originated
   by a particular PE or Autonomous System Border Router (ASBR), it
   identifies a tunnel that the PE/ASBR uses by default for carrying the
   multicast traffic of a particular customer MVPN.  The proper encoding
   and interpretation of the PMSI Tunnel attribute is affected by both
   the AFI and &quot;Network Address of Next Hop&quot; fields.

<span class="h3"><h3><a class="selflink" name="section-4.1" href="https://tools.ietf.org/html/rfc6515#section-4.1">4.1</a>. Relationship to AFI Value</h3></span>

   When the PMSI Tunnel Attribute occurs in a BGP Update message with a
   MP_REACH_NLRI attribute whose AFI is 1, the meaning is that the
   identified tunnel is used by default to carry IPv4 MVPN traffic for a
   particular customer MVPN. When the PMSI Tunnel Attribute occurs in a
   BGP Update message with a MP_REACH_NLRI attribute whose AFI is 2, the
   meaning is that the identified tunnel is used by default to carry
   IPv6 MVPN traffic for a particular customer MVPN.  To assign both
   IPv4 and IPv6 MVPN traffic to an I-PMSI tunnel, two I-PMSI A-D routes
   MUST be used -- one whose MP_REACH_NLRI has an AFI of 1 and one whose
   MP_REACH_NLRI has an AFI of 2.  To use the same tunnel for both IPv4
   and IPv6 traffic, the same value of the PMSI Tunnel attribute can be
   used in each route.

<span class="h3"><h3><a class="selflink" name="section-4.2" href="https://tools.ietf.org/html/rfc6515#section-4.2">4.2</a>. Relationship to Next Hop Address Family</h3></span>

   If the &quot;Network Address of Next Hop&quot; field in the MP_REACH_NLRI
   attribute contains an IPv4 address, then any IP addresses appearing
   in the &quot;Tunnel Identifier&quot; field of the PMSI Tunnel Attribute MUST be
   IPv4 addresses.

   If the &quot;Network Address of Next Hop&quot; field in the MP_REACH_NLRI
   attribute contains an IPv6 address, then any IP addresses appearing
   in the &quot;Tunnel Identifier&quot; field of the PMSI Tunnel Attribute MUST be
   IPv6 addresses.

   If these conditions are not met, the PMSI Tunnel Attribute MUST be
   handled as a &quot;malformed&quot; PMSI Tunnel Attribute, as specified in
   Section 5 of [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].







<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 6]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-7" id="page-7" href="https://tools.ietf.org/html/rfc6515#page-7" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


<span class="h2"><h2><a class="selflink" name="section-5" href="https://tools.ietf.org/html/rfc6515#section-5">5</a>. IANA Considerations</h2></span>

   IANA has assigned the code point 0x000b for &quot;VRF Route Import&quot; in the
   &quot;IPv6 Address Specific Extended Community&quot; registry in the
   &quot;transitive communities&quot; portion of the namespace.  The references
   are to this document and to [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].

<span class="h2"><h2><a class="selflink" name="section-6" href="https://tools.ietf.org/html/rfc6515#section-6">6</a>. Security Considerations</h2></span>

   This document does not raise any security considerations beyond those
   raised by [<a href="https://tools.ietf.org/html/rfc6515#ref-MVPN-BGP" title="&quot;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs&quot;">MVPN-BGP</a>].

<span class="h2"><h2><a class="selflink" name="section-7" href="https://tools.ietf.org/html/rfc6515#section-7">7</a>. Acknowledgments</h2></span>

   The authors wish to thank Dongling Duan, Keyur Patel, Yakov Rekhter,
   and Karthik Subramanian.

<span class="h2"><h2><a class="selflink" name="section-8" href="https://tools.ietf.org/html/rfc6515#section-8">8</a>. Normative References</h2></span>

   [<a name="ref-BGP" id="ref-BGP">BGP</a>]      Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., &quot;A
              Border Gateway Protocol 4 (BGP-4)&quot;, <a href="https://tools.ietf.org/html/rfc4271">RFC 4271</a>, January
              2006.

   [<a name="ref-BGP-MP" id="ref-BGP-MP">BGP-MP</a>]   Bates, T., Chandra, R., Katz, D., and Y. Rekhter,
              &quot;Multiprotocol Extensions for BGP-4&quot;, <a href="https://tools.ietf.org/html/rfc4760">RFC 4760</a>, January
              2007.

   [<a name="ref-MVPN" id="ref-MVPN">MVPN</a>]     Rosen, E., Ed., and R. Aggarwal, Ed., &quot;Multicast in
              MPLS/BGP IP VPNs&quot;, <a href="https://tools.ietf.org/html/rfc6513">RFC 6513</a>, February 2012.

   [<a name="ref-MVPN-BGP" id="ref-MVPN-BGP">MVPN-BGP</a>] Aggarwal, R., Rosen, E., Morin, T., and Y. Rekhter, &quot;BGP
              Encodings and Procedures for Multicast in MPLS/BGP IP
              VPNs&quot;, <a href="https://tools.ietf.org/html/rfc6514">RFC 6514</a>, February 2012.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>, March 1997.

<span class="h2"><h2><a class="selflink" name="section-9" href="https://tools.ietf.org/html/rfc6515#section-9">9</a>. Informative References</h2></span>

   [<a name="ref-RFC4291" id="ref-RFC4291">RFC4291</a>]  Hinden, R. and S. Deering, &quot;IP Version 6 Addressing
              Architecture&quot;, <a href="https://tools.ietf.org/html/rfc4291">RFC 4291</a>, February 2006.

   [<a name="ref-RFC4364" id="ref-RFC4364">RFC4364</a>]  Rosen, E. and Y. Rekhter, &quot;BGP/MPLS IP Virtual Private
              Networks (VPNs)&quot;, <a href="https://tools.ietf.org/html/rfc4364">RFC 4364</a>, February 2006.

   [<a name="ref-RFC4659" id="ref-RFC4659">RFC4659</a>]  De Clercq, J., Ooms, D., Carugi, M., and F. Le Faucheur,
              &quot;BGP-MPLS IP Virtual Private Network (VPN) Extension for
              IPv6 VPN&quot;, <a href="https://tools.ietf.org/html/rfc4659">RFC 4659</a>, September 2006.



<span class="grey">Aggarwal &amp; Rosen             Standards Track                    [Page 7]</span></pre> 
   <hr class="noprint" style="width: 96ex;" align="left" />
   <!--NewPage-->
   <pre class="newpage"><a name="page-8" id="page-8" href="https://tools.ietf.org/html/rfc6515#page-8" class="invisible"> </a>
<span class="grey"><a href="https://tools.ietf.org/html/rfc6515">RFC 6515</a>              MVPN Infrastructure Addresses        February 2012</span>


   [<a name="ref-RFC4798" id="ref-RFC4798">RFC4798</a>]  De Clercq, J., Ooms, D., Prevost, S., and F. Le Faucheur,
              &quot;Connecting IPv6 Islands over IPv4 MPLS Using IPv6
              Provider Edge Routers (6PE)&quot;, <a href="https://tools.ietf.org/html/rfc4798">RFC 4798</a>, February 2007.

   [<a name="ref-RFC4684" id="ref-RFC4684">RFC4684</a>]  Marques, P., Bonica, R., Fang, L., Martini, L., Raszuk,
              R., Patel, K., and J. Guichard, &quot;Constrained Route
              Distribution for Border Gateway Protocol/MultiProtocol
              Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual
              Private Networks (VPNs)&quot;, <a href="https://tools.ietf.org/html/rfc4684">RFC 4684</a>, November 2006.

   [<a name="ref-RFC5549" id="ref-RFC5549">RFC5549</a>]  Le Faucheur, F. and E. Rosen, &quot;Advertising IPv4 Network
              Layer Reachability Information with an IPv6 Next Hop&quot;, <a href="https://tools.ietf.org/html/rfc5549">RFC</a>
              <a href="https://tools.ietf.org/html/rfc5549">5549</a>, May 2009.

   [<a name="ref-RFC5701" id="ref-RFC5701">RFC5701</a>]  Rekhter, Y., &quot;IPv6 Address Specific BGP Extended Community
              Attribute&quot;, <a href="https://tools.ietf.org/html/rfc5701">RFC 5701</a>, November 2009.

Authors' Addresses

   Rahul Aggarwal
   Juniper Networks
   1194 North Mathilda Avenue
   Sunnyvale, CA 94089
   EMail: raggarwa_1@yahoo.com

   Eric C. Rosen
   Cisco Systems, Inc.
   1414 Massachusetts Avenue
   Boxborough, MA 01719
   EMail: erosen@cisco.com





















Aggarwal &amp; Rosen             Standards Track                    [Page 8]

</pre>
   <br /> 
   <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a> </small></small></span> 
  </div> 
 </body>
</html>